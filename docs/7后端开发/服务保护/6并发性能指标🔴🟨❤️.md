# 并发性能指标

## 最佳实践

### 考察问

- QPS: Queries Per Second, `()`
- RT: Response time, `()`
- Concurrency: 并发量, 系统同时处理请求的数量(`()`, 但会争抢CPU时间)
- Concurrency = `()`


### 考察点


- QPS: Queries Per Second, `每秒处理查询的个数`
- RT: Response time, `响应时间`
- Concurrency: 并发量, 系统同时处理请求的数量(`线程数`, 但会争抢CPU时间)
- Concurrency = `QPS*Avg(RT)`


## QPS(每秒查询)和TPS(每秒事务)

QPS：Queries Per Second是衡量信息检索系统（例如搜索引擎或数据库）在一秒钟内接收到的搜索流量的一种常见度量。该术语在任何请求-响应系统中都得到更广泛的使用，更正确地称为每秒请求数（RPS：Request Per Second）。

TPS：是Transactions Per Second的缩写，也就是事务数/秒。

QPS vs TPS：QPS基本类似于TPS，但是不同的是，对于一个页面的一次访问，形成一个TPS；但一次页面请求，可能产生多次对服务器的请求，服务器对这些请求，就可计入“QPS”之中。如，访问一个页面会请求服务器2次，一次访问，产生一个“T”，产生2个“Q”。


## RT(响应时间)

RT（Response-time）响应时间：执行一个请求从开始到最后收到响应数据所花费的总体时间，即从客户端发起请求到收到服务器响应结果的时间。

暂时忽略传输时间，响应时间是处理时间和等待时间的总和。处理时间是完成请求要求的工作所需的时间，等待时间是请求在被处理之前必须在队列中等待的时间。

## Concurrency(并发量)

当有多个线程在操作时，如果系统只有一个 CPU，则它根本不可能真正同时进行一个以上的线程，它只能把 CPU 运行时间划分成若干个时间段，再将时间段分配给各个线程执行。
在一个时间段的线程代码运行时,其它线程处于挂起状态，这种方式我们称之为并发（Concurrent）。



## 吞吐量


单个处理请求对CPU消耗越高，外部系统接口、IO速度越慢，系统吞吐能力越低，反之越高。

系统吞吐量有几个重要指标参数：QPS（TPS）、并发量、响应时间。

- QPS（TPS）：（Queries Per Second）每秒钟请求/事务数量。
- 响应时间(RT)： 一般取平均响应时间。
- 并发量： 系统同时处理的请求/事务数。


它们之间的关系：

- 并发量 = QPS*Avg(RT)

🌰已知 QPS 目标和预期 Avg (RT)，可算出所需并发支撑能力（例：QPS=1000，Avg (RT)=0.1 秒，需 100 并发量）。

🌰如果每天 80% 的访问集中在 20% 的时间里，这 20% 的时间就叫做峰值时间。

- 峰值时间每秒请求数(QPS) = ( 总PV数 * 80% ) / ( 每天秒数 * 20% )
- 机器数 = 峰值时间每秒QPS / 单台机器的QPS =




## 参考

- [指标](https://zhuanlan.zhihu.com/p/337708438)
- https://bbs.huaweicloud.com/blogs/440043




