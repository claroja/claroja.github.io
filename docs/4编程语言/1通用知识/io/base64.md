# base64



Base64，顾名思义，就是包括小写字母a-z、大写字母A-Z、数字0-9、符号"+"、"/"一共64个字符的字符集，（另加一个“=”，实际是65个字符，至于为什么还会有一个“="，这个后面再说）。任何符号都可以转换成这个字符集中的字符，这个转换过程就叫做base64编码。


base64怎么转换
首先将字符串（图片等）转换成二进制序列，然后按每6个二进制位为一组，分成若干组，如果不足6位，则低位补0。每6位组成一个新的字节，高位补00，构成一个新的二进制序列，最后根据base64索引表中的值找到对应的字符。

## Base64索引表
Base64的编码表可以分成四个部分:
1. 大写字母 (0-25): ABCDEFGHIJKLMNOPQRSTUVWXYZ
2. 小写字母(26-51): abcdefghijklmnopqrstuvwxyz
3. 数字(52-61): 0123456789
4. 特殊字符(62-63): +/

注意:
等号`=`是为了填充空白, 为了保证Base64的编码的值长度是4字节的整数倍, 它没有索引号.

### Uppercase Letters
Index|Character
--|--
0|A
1|B
2|C
3|D
4|E
5|F
6|G
7|H
8|I
9|J
10|K
11|L
12|M
13|N
14|O
15|P
16|Q
17|R
18|S
19|T
20|U
21|V
22|W
23|X
24|Y
25|Z


### Lowercase Letters
Index|Character
--|--
26|a
27|b
28|c
29|d
30|e
31|f
32|g
33|h
34|i
35|j
36|k
37|l
38|m
39|n
40|o
41|p
42|q
43|r
44|s
45|t
46|u
47|v
48|w
49|x
50|y
51|z

### Digits
Index|Character
--|--
52|0
53|1
54|2
55|3
56|4
57|5
58|6
59|7
60|8
61|9

### Symbols
Index|Character
--|--
62|+
63|/


## 举例
以两个字节为例, 假设我们有两个字母的字符串`ab`,对应两个字节.一共16位, 按6位分为一组, 可分为三组, 在每组的高位补00, 最有一组因为只有四位, 所以在低位补00, 这时就形成了三个字节. 为了凑成四个字节, 最后一个字节用`=`代替.

注意: base64编码成的结果肯定是四字节的整数倍
因为base64编码, 是取6bit位, 然后填充2bit位. 当是三个字节(或三字节的整数倍时)都可以编码成四个字节, 而当非三个字节(或三个字节的整数倍时), 则使用`=`号来填充. 这样在解码的时候, 就可以按四个字节开取, 提升效率.


原始字符|a|b| | |
--|--|--|--|--
ascii|97|98| | |
二进制|01100001|01100010| | |
6位编码转换|00011000|00010110|00001000| |
base64索引|24|22|8| |
base64字符|Y|W|I|=|



## 应用场景
1. html中的图片用base64表示
某些样式中的图片不是一个资源地址，而是base64编码的字符串，这么做有什么好处呢？ 当然是减少了一次http的请求. 
如果是图片的链接的话, 需要再发一次get请求, 而如果是base64编码, 则可以直接写到html中.

2. 邮件传输
电子邮件刚问世的时候，只能传输英文，但后来随着用户的增加，中文、日文等文字的用户也有需求，但这些字符并不能被服务器或网关有效处理，因此Base64就登场了。随之，Base64在URL、Cookie、网页传输少量二进制文件中也有相应的使用。

3. 64个可打印的字符来表示二进制的数据
在参数传输的过程中经常遇到的一种情况：使用全英文的没问题，但一旦涉及到中文就会出现乱码情况。与此类似，网络上传输的字符并不全是可打印的字符，比如二进制文件、图片等。Base64的出现就是为了解决此问题，它是基于64个可打印的字符来表示二进制的数据的一种方法。

## python

注意`b64encode`方法传入的参数是二进制对象`b`, 不是普通的字符串.
```python
## 编码
base64.b64encode(b'abc')
## b'YWJj'
## 解码
base64.b64decode(b'YWJj')
## b'abc'
```

### url_safe

​除了基本的base64，还有一种url safe 形式的编码方式，目的是将“+/” 替换成 “-_”， 因为标准的Base64并不适合直接放在URL里传输，URL编码器会把标准Base64中的“/”和“+”字符变为形如“%XX”的形式，而这些“%”号在存入数据库时还需要再进行转换。

```python
base64.b64encode(b'i\xcf\xbf')
## b'ac+/'
## 使用"url safe"的base64编码会把+/ 替换成 -_
base64.urlsafe_b64encode(b'i\xcf\xbf')
## b'ac-_'
```



参考:
https://zhuanlan.zhihu.com/p/339477329
https://base64.guru/learn/base64-characters
https://zhuanlan.zhihu.com/p/113483856