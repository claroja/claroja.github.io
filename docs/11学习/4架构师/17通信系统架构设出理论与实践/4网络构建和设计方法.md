# 网络构建和设计方法

## 网络需求分析

需求分析过程，主要围绕以下几个方面来开展：业务需求、用户需求、应用需求、计算机平台需求和网络需求。

(1) 业务需求梳理就是调查和理解业务本质，尽可能保证设计的网络满足业务的需求。其间需要确定业务主要干系人，确定关键时间点以及确定网络的投资规模，明确业务活动，预测业务增长率进而预判网络发展的趋势，确定网络可靠性和可用性指标，确定网络安全性，以及确定网络远程访问要求等。通过梳理，形成业务需求清单。
(2) 用户需求收集需从当前网络的用户开始，识别并明确用户需要的重要服务或功能。收集用户需求，可考虑从与用户群交流，准确、深入理解用户服务、需求归档几方面入手。通过与特定个人或群体进行交流，可采取观察和问卷调查，集中访谈、采访关键干系人等方式，以确保网络建设不偏离用户需求；正确理解用户服务，就是从用户描述的碎片化、模糊的、难以量化的需求中分析提取用户的真实需要，如信息传输的及时性，响应时间的容忍度，网络服务的可靠性、可用性，网络的适应性、可伸缩性、安全性，以及建网成本等等。最后，通过需求归档，将梳理的用户需求记录下来，形成用户服务表，作为网络设计需求规范编制的依据。
(3) 应用需求收集主要考虑如下因素：应用类型和地点、使用方法、需求增长性、可靠性和可用性要求、网络响应时间要求等。关于应用类型，可按功能分类，也可按共享与否分类，还可按响应及时性分类，甚至也可按网络模型分类等，进行应用需求梳理。关于使用方法，主要考虑用户对资源的存取和访问的要求，可通过各种指标进行量化。通过对应用需求进行分析，输出应用需求表，其中体现应用需求的量化指标。
(4) 计算机乎台需求主要是明晰网络所接入的设备类型，如个人 PC 、工作站、小型机、中型机、大型机等。通过统计，形成所需提供服务的设备类型需求表。
(5) 网络需求是需求分析的最后一项工作，就是要考虑网络管理员的需求。网络需求主要涉及局域网功能、网络拓扑结构、网络性能、网络管理、网络安全、城域网／广域网连接方案选择。通过对网络需求进行分析，形成网络需求的分项需求表。

通过上述 5 个需求分析后，最终形成约束后续网络设计的网络需求规格说明书。



## 网络技术遴选及设计

网络遴选工作是通信系统设计中关键的一项工作，根据计划实施的网络建设要求，遴选工作通常分为局域网、广域网和路由协议的选择。

### 局域网技术遴选

1. 生成树协议 (Spanning Tree Protocol,  STP) 

    在局域网构建中，几乎离不开二层交换机的选择，在选择了二层交换机组网时，通常为了提高网络的可用性，网络会设计成有冗余或可扩展的结构，这样，极可能形成环路。为了避免此情况发生，需要在二层交换机上采用 STP 协议。 STP 协议是在 IEEE802 ．标准中定义的，分为".1d"".lw”“1s” 等多个版本，以适应不同的需求。详细差别可参考相关资料。

2. 虚拟局域网

    构建虚拟局域网 (VLAN), 可将一个物理网络划分成若干个相互隔离的逻辑网络，形成不同的广播域，从而将不同部门或用途的设备规划到各自的虚拟网络中，实现信息访问的隔离。

3. 无线局域网

    由于无线局域网接入的便捷性，目前，无线局域网在企事业单位或组织内被广泛使用。

    一个无线局域网是由若干 AP 组成，一个 AP 能覆盖的区域(即一个无线单元)范围是有限的。在设计无线局域网结构时，需要从以下几个方面予以考虑：

    - 定位AP实现最大覆盖率，确保目标区域得以全覆盖；
    - 无线局域网的虚拟网规划，如尽可能将所有无线接入设备划分到一个虚拟网络内；
    - 冗余无线接入点布放，确保在一个区域同时由一个以上AP提供无线覆盖，从而避免一个AP故障后，可由其他AP接替以提供接入服务；
    - 网络SSID配置，在一个园区或企业、组织内，所有AP都应设置成同一SSID 。

4. 线路冗余设计

    为提升局域网高可用性，局域网交换机之间设计冗余链路是颇为常见的做法。冗余链路可采用备份或负荷分担两种方式来提高业务传输能力。备份方式是指采用 STP 协议可避免环路发生。此方式在提升网络高可用性同时也带来了资源浪费；负荷分担方式是指在设备转发业务时需要设置适合的均衡策略，使得业务尽可能均衡分担到不同链路上。此方式在提升网络传输可用性同时，可避免冗余链路在网络中闲置。

5. 交换设备功能的合理使用

    交换设备(如交换机)是局域网的核心设备，除了实现基本的数据存储转发功能外，还需要考虑其他特殊功能的利用，以提升网络的服务质量。如：链路聚合设置、冗余网关布设、以太网供电、多业务模块灵活支持等。

6. 服务器冗余设计

    为提升服务器性能和工作负载能力，一些组织或单位会配置多台服务器来提供服务。在实现各台服务器服务均衡上通常需要考虑以下几种方式：
    (1)使用负载均衡器：通过使用前置负载均衡设备，将接入的服务请求均衡到不同的业务服务器上。
    (2) 使用网络地址转换：通过使用负载均衡的地址转换网关，将来自外部的服务请求地址(外部地址)转换为多个内部服务器地址，从而达到服务的均衡调度。
    (3) 使用 DNS 服务器：通过 DNS 将一组业务服务器(每个服务器设置不同的 IP 地址)的地址映射到同一域名上，使得 DNS 服务器在向用户返回请求服务的业务接入点地址时，循环返回一组地址中的一个，从而达到业务服务器均衡访问的目的。
    (4) 使用高可用技术：如采用双机热备系统(即高可用集群系统)以保证业务系统服务提供的连续性。采用双机热备系统提供服务的高可用性，主要有两种工作模式：单活(一主一备，Active-Standby)和双活 (Active-Active) 。



### 广域网技术遴选


l) 远程接入技术

    当今社会，不少组织、企业或公司等单位在运营中规模不断壮大，随之出现异地办公，职员流动办公等运作模式，这就促使单位网络需支待网络用户特殊的接入方式。一般来讲，主要有以下接入技术： PSTN 接入技术、综合业务数据网接入技术、电缆调制解调器远程接入技术、数字用户线路 (DSL) 远程接入技术、无源光网络 (PON) 技术、无线宽带接入技术、小区宽带接入和电力通信技术 (PLC) 等。

    远程接入技术选择需要从现有网络的建设情况，用户接入网络需要开展的业务特点或需求，以及接入方式需支付的费用等因素综合考虑加以取舍。

2) 广域网互连技术

    在企业或组织需要将不同地域的分部网络互连在一起的时候就需要考虑广域网的互连方式。通常有以下互连技术：数字数据网络 (Digital Data Network,  DDN) 技术、同步数字体系(Synchronous  Digital Hierarchy,  SDH) 技术、 MSTP (Mu lti-Service Transport Platform) 技术和VPN 接入技术。此外，广域网互连时还需要考虑性能优化方面的问题，如可利用路由器实现预留带宽、利用拨号线路、传输数据压缩、链路聚合、数据基于优先级排序、基千协议带宽预留等策略实现广域网性能的有效提升。


### 地址规划模型

地址规划分配，是网络管理工作的重点内容。合理的地址规划不仅为网络管理带来便利，也有利于路由协议的收敛。地址分配应遵循以下原则：
(1) 使用结构化网络层编址模型，即对地址进行层次化的规划。
(2) 通过中心授权机构管理地址，比如由组织的 IT 部门为网络层编址提供一个全局模型。根据网络的核心、汇聚、接入层次化结构，为组织的各个区域、分支机构等进行地址规划。
(3) 编址授权下发。即由地址授权管理中心，将编址授权给分支机构来进行地址规划。
(4) 为终端用户设备指派动态地址，即对千频繁变更位置、移动性角度的用户分配动态地址。
(5) 私有地址合理使用。使用私有地址在组织内互访具有很高安全性，避免来自外部网络攻击。使用私有地址的用户在访问外部网络，需要进行地址转换 (NAT), 因此，还需要做好NAT 地址池的规划。


### 路由协议选择
路由协议选择包括以下内容：
(1)路由协议类型的选择：路由协议选择主要包括距离矢量协议和链路状态协议。
(2) 路由选择协议度量值的合理设置。
(3) 路由选择协议顺序的合理指定。
(4) 层次化与非层次化路由选择协议。
(5) 内部与外部路由选择协议。
(6) 分类与无类路由选择协议。
(7) 静态路由指定。


### 层次化网络模型设计


层次化网络设计模型，可帮助设计者按照层次设计网络架构，并对不同层次赋予特定网络功能，选择适合的设备／系统。在典型层次化网络结构中，核心层通常选用具备高可用性和性能优化的高端路由器／交换机；汇聚层通常选取实现策略的路由器和交换机；接入层通常选用低端交换机连接用户设备。

在 17.2 节网络架构介绍中，层次局域网、层次子域广域网结构，就是层次化网络设计模型分别在局域网和广域网设计中的应用。层次化网络设计模型，由千更适合于网络用户不断增加，网络复杂度不同增大的场景，因此，也成为位千网络主流地位的园区网的经典模型。


1. 层次化设计优点

    网络采用层次化模型设计具有如下优点：
    (1) 使用层次化模型可使得网络成本降至最低。各层仅考虑自身的功能实现要求，以及运维资源要求，避免各层中不必要特性所花费的资金。
    (2) 层次化设计可充分利用不同层次成熟的模块化设备或部件，既避免不必要开发费用，也利千网络稳定运行。
    (3) 层次化设计使得网络因需求而变化或演化更加容易。


2. 三层层次化模型设计思路

    层次化模型设计中最为经典的是三层层次化模型。下面给出三层层次化模型设计思路。三层层次化模型将网络分为核心层、汇聚层、接入层。各层提供不同的功能。核心层提供不同区域或者下层的高速连接和最优传送路径；汇聚层将网络业务连接到接入层，执行与安全、流量负载、路由相关的策略；接入层为局域网接入广域网，或终端用户访问网络提供接入能力。
    (1) 核心层设计思路。核心层是网络互连的枢纽，极其重要，设计中应采用冗余机制，保证其高可用性，并能快速应对变化。功能设计上，应避免使用数据包过滤、策略路由等处理开销大的特性，降低核心层处理时延。另外，核心层覆盖范围不易过大，连接设备也不易过多，确保核心层具备良好的管理性；核心层提供的功能不宜多样化，避免降低核心网络设备性能。
    (2) 汇聚层设计思路。在汇聚层，应尽量提供出千安全性原因对资源的访问控制功能，以及出千性能原因对核心层流量的控制功能等。通过汇聚层，使得接入层的网络细节信息对核心层透明。譬如接入层的子网划分，在汇聚层向核心层路由通告时进行屏蔽，仅将汇聚后的大的子网信息上报至核心层。另外，汇聚层还应对接入层屏蔽网络其他部分的细节信息，如在路由通告时仅向接入设备宣告自身的默认路由。
    (3) 接入层设计思路。接入层为用户设备提供在本地网段访问应用系统，以及互访的能力，同时为这些访问提供足够带宽支持。此外，需要负责用户管理功能，如地址认证、用户认证、计费管理等；还需要负责收集一些用户信息的工作，如用户 IP/MAC 地址，访问日志等信息。


3. 层次化设计应遵循原则
    (1)设计者应尽量控制网络层次，避免过多层次导致网络性能下降，增加网络时延。
    (2) 应首先从接入层进行设计，通过对流量负荷、行为的分析，来对上层进行精细化容量规划，依次完成各层的设计。
    (3) 网络设计时应尽量采用模块化方式实现各层的功能，模块间边界清晰。
    (4) 应在接入层对网络结构进行严格控制，以避免接入层用户改用非正常的访问外部网络的渠道，获得更大的带宽。
    (5) 严格控制网络的层次化结构，以避免跨层加入额外连接，导致网络非法访问或网络异常等问题。

### 网络高可用设计方法


在进行网络设计时，必然需要面对网络的可用性 (Avai labi lity)和可靠性 (Reliabi l ity)问题。它们是衡量一个网络好坏的重要指标。可靠性指的是网络连续无故障运行时间的长短，无故障运行时间越长，可靠性越高；可用性指的是，在较长时间(比如一年等)里网络可用的时间长短，可用时间越长，可用性越高。

1. 提高网络可用性的途径

    以下举两个极端例子来说二者的关系。

    假如一个网络可靠性很高，平均可以稳定运行 10 年，但是一旦网络出现故障，要用一年的时间来恢复，那么它的可用性只有 90% 。再譬如另一个网络，可靠性很差，平均运行 10 秒就会异常一次，但是恢复很快，只需要 lms 就可恢复，那么它的可用性是 99.99% 。

    通过这两个例子可以看出，提高网络可用性可采取两条途径：
    (1)提高网络可靠性，影响可靠性的因素很多，包括硬件、软件、运维、环境等。其中，软件的 Bug是影响可靠性的最主要因素。从某种意义上来说，提高软件质量相比较于使用更可靠硬件更具有成本优势。
    (2) 缩短网络恢复时间，一旦网络出现故障，如能在秒级，甚至毫秒级得以恢复，那么对业务影响则很小。

    可见，构建高可用网络，需要从耐久性、容错性及可维护性等方面进行网络规划设计。

2. 设计的核心思想

    网络系统可靠性／可用性设计的核心思想是通过合理设计组网结构和应用可靠性特性，使得网络系统软件硬件部件运行可靠，具备冗余备份、自动检测和快速恢复机制，同时也应权衡不同类型网络构建成本。

3. 设计原则


    网络可靠性／可用性设计原则：不同的网络、服务的业务场景不尽相同，其可靠性／可用性设计目标也不同。网络解决方案需要根据实际需求进行设计。高可靠、可用性网络不但涉及网络架构、设备选型、协议选择等技术层面问题，还受用户现有网络状况、投资预算，以及用户管理水平等影响。因此，在网络规划时，须因地制宜，综合考虑各方面影响因素。

    网络结构通常规划为核心层、汇聚层和接入层。网络层次越高，其影响面越广，其可靠性、可用性要求也越高。在方案设计时，采用分层架构，不同层次解决不同级别的可靠性、可用性问题。

    为保证网络可靠性／可用性，有关可靠性／可用性技术的实施并非简单叠加和无限制冗余，否则，一来会带来过高的网络建设成本，二来也增加了网络维护复杂度，给网络引入潜在故障隐患。

    因此，在网络设计时应根据网络结构、类型、层次，分析网络业务模型，确定网络拓扑，识别影响网络可靠性、可用性的关键节点和链路，合理规划和部署相适应的高可用技术。在网络可靠性规划实施时，应在保证网络各层满足可靠性要求基础上，尽量降低网络复杂度，适度控制成本，设计出最适合的方案。避免一味追求可靠性而忽视系统的整体成本和性能，换言之，构建网络应是一个平衡各方面因素的过程。

## 网络安全

### 防火墙布设

防火墙是设置在两个或多个网络之间的安全屏障，用千保障本地网络资源的安全。其作用在千通过允许、拒绝或重定向经过防火墙的数据流，实现对可信网络的保护，同时对进出网络的服务或访问进行审计。

防火墙可以是基于软件的，也可以是基千硬件的，还可以是嵌入式的等形态。就防火墙采用的技术来说，有包过滤型、应用层网关、代理服务型等种类。就防火墙体系而言，有双重宿主机结构、被屏蔽主机结构、被屏蔽子网结构等形式。实际组网中应根据网络安全要求合理选择。

### VPN 技术

VPN  (Virtual Private Network) 是指利用公共网络来建立私有专用网络的一种技术。 VPN中数据通过安全加密通道完成传送。使用 VPN 有节省建网成本、方便提供远程访问、网络可扩展性强、便千管理和实现全面控制等益处。主要 VPN 技术包括 IPSec 、 GRE 、 MPLS VPN、VPDN 等。


### 访问控制技术

网络的发展为信息共享提供了便利，但同时也给敏感信息任意访问带来潜在风险。因此对网络资源的访问加以控制尤为重要。

访问控制是主体依据控制策略或权限对客体本身或其资源实施的不同授权访问。访问控制涉及认证、控制策略实现和审计三个环节。在实现上，有访问控制矩阵、访问控制表、能力表等技术手段。就访问控制模型而言，有传统的自主型访问控制和强制型访问控制；有基千角色的访问控制、基于任务的访问控制、基于对象的访问控制等多种模型。


### 网络安全隔离

网络安全隔离是在网络运行过程中将网络攻击隔离在可信网络之外，同时保证可信网络内信息不被外泄。网络安全隔离又分为分子网隔离、 VLAN 隔离、逻辑隔离、物理隔离等形式。


### 网络安全协议

网络安全运行离不开安全协议的支撑。其中比较典型的安全协议有 SSL/SET/HTTPS 等。
SSL 协议：是网景公司面向 Web 应用提出的安全协议。该协议指定了一种在应用层协议和 TCP/IP 协议之间提供数据安全性控制的机制。它为 TCP/IP 连接提供数据加密、服务器认证、消息完整性保护、客户机认证等能力。该协议主要包括记录协议、告警协议和握手协议三部分。

SET 协议：即安全电子交易协议，由 VISA、 MasterCard 等多家公司联合推出。它主要用千解决用户、商家和银行之间通过信用卡支付的交易问题，保证支付信息的机密、支付过程的完整、商户和待卡人身份合法性及可操作性。

HTTPS 协议：是基千 SSL 或 TLS 进行 HTTP 交互的协议，用于在客户计算机和服务器之间交换信息。它使用安全套接字层进行信息交互，所有交互数据均被加密。对于启用 HTTPS 协议的服务器，需要预先生成一个电子证书。同时，客户计算机需要安装证书。借用证书，客户计算机和服务器之间完成相互身份认证，双方通过密钥对数据加密来实现信息交换。

### 网络安全审计


安全审计是对网络的脆弱性进行测试评估和分析，最大限度保障业务的安全正常运行的一切行为和手段。其主要包括安全审计自动响应、安全审计数据生成、安全审计分析、安全审计浏览、安全审计事件存储和安全审计事件选择等功能。
















