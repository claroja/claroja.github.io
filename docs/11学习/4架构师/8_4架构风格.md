# 软件架构风格

## 最佳实践

### 考察问

1. 🔴🟨❤️软件架构风格概念:`()`,`()`,`()`
    1.`()`: 构件和连接件
    2.`()`: 如何将构件和连接件`组合`
2. 软件架构风格概念
    1. 🔴🟨❤️`()`(显式调用): 系统由组件, 递归构成
        1. 四种子类型:
            1.`()`(面相过程): 主程序直接调用子程序
            2.`()`: 构件是对象，通过对象调用封装的方法和属性
            3.`()`: 每层最多影响其`上下两层`
            4.`()`: 数据库服务器, 客户应用程序, 网络
        2. 特点:`()`耦合
        3. 案例:
    2. 🔴🟨❤️`()`: 系统由组件顺序构成.
        1. 两种子类型:
            1.`()`:整体传递
            2.`()`:单个传递
        2. 特点:`()`耦合,`()`交互性,`()`拓展性,`()`并行,`()`重用
        3. 案例:`()`编译器
    3. 🔴🟨❤️`()`: 构件之间是互相独立, 通过中间件或事件传递消息
        1. 两种子类型
            1.`()`: 进程之间`消息传递`
            2.`()`: `隐式调用`
        2. 特点: 松耦合, 可扩展性
        3. 案例: 语法高亮、语法错误提示
    4. 🔴🟨❤️`()`: 数据为中心, 处理单元独立
        1. 两种子类型
            1. `()`:
            2. `()`: 中央数据结构（黑板）来协调多个独立的处理单元（知识源）
        2. 特点:`()`交互性,`()`拓展性,`()`并行
        3. 案例: 语音处理, 图像处理, 知识推理
    5. 🔴🟨❤️`()`: 构造运行环境, 解析语言
        1. 两种子类型
            1. `()`: 边分析边执行
            2. `()`: 规则集、规则解释器、规则/数据选择器, 工作内存
        2. 特点:
        3. 案例: JAVA虚拟机, 专家系统
    6. C2: 通过连接件绑定在一起按照一组规则运作的并行构件网络
    7. 过程控制: 发出控制命令并接受反馈，循环往复达到平衡。

### 考察点

1. 软件架构风格概念: `特定领域`, `系统组织`, `惯用模式`
    1. `词汇表`: 构件和连接件
    2. `约束`: 如何将构件和连接件组合
2. 软件架构风格概念
    1. 调用返回(显示调用): 系统由组件, 递归构成
        1. 四种子类型:
            1. `主程序子程序`(面相过程): 主程序直接调用子程序
            2. `面相对象`: 构件是对象，通过对象调用封装的方法和属性
            3. `层次型`: 每层最多影响其`上下两层`
            4. `C/S(B/S)`: 数据库服务器, 客户应用程序, 网络
        2. 特点: `紧`耦合
        3. 案例:
    2. 数据流: 系统由组件顺序构成.
        1. 两种子类型:
            1. `批处理`: 整体传递
            2. `管道过滤器`: 单个传递
        2. 特点: `低`耦合, `低`交互性, `高`拓展性, `可`并行, `可`重用`
        3. 案例: `传统`编译器
    3. 独立构件: 构件之间是互相独立, 通过中间件或事件传递消息
        1. 两种子类型
            1. `进程通信`: 进程之间`消息传递`
            2. `事件驱动`: 基于事件的`隐式调用`，通过事件驱动,
        2. 特点: 松耦合, 可扩展性
        3. 案例: 语法高亮、语法错误提示
    4. 以数据为中心: 数据为中心, 处理单元独立
        1. 两种子类型
            1. `仓库`:
            2. `黑板`: 中央数据结构（黑板）来协调多个独立的处理单元（知识源）
        2. 特点: `好`交互性, `好`拓展性, `不`并行
        3. 案例: 语音处理, 图像处理, 知识推理
    5. 虚拟机: 构造`运行环境`, 解析语言
        1. 两种子类型
            1. `解释器`: 边分析边执行
            2. `规则中心`: 规则集、规则解释器、规则/数据选择器, 工作内存
        2. 特点:
        3. 案例: JAVA虚拟机, 专家系统
    6. C2: 通过连接件绑定在一起按照一组规则运作的并行构件网络
    7. 过程控制: 发出控制命令并接受反馈，循环往复达到平衡。

## 软件架构风格概述

软件架构风格是描述某一`特定应用领域`中`系统组织方式`的`惯用模式`。架构风格定义一个系统家族，即一个架构定义`一个词汇表`和`一组约束`。

1. `词汇表`中包含一些`构件和连接件`类型
2. `约束`指出系统是`如何`将这些构件和连接件`组合`起来的。

架构风格反映了领域中众多系统所共有的结构和语义特性，并指导如何将各个模块和子系统有效地组织成一个完整的系统。对软件架构风格的研究和实践促进对设计的重用，一些经过实践证实的解决方案也可以可靠地用于解决新的问题。

架构风格定义了用于描述系统的术语表和一组指导构建系统的规则。

软件架构设计的一个核心目标问题是能否达到架构级的软件复用。

🔒题目:

1. ❤️软件架构风格描述某一特定应用领域中系统组织方式的惯用模式。架构风格定义一个系统家族，即一个体系结构定义______。

    - A. 一组构件和一组约束
    - B. 一组模块和一个连接件
    - C. 一个词汇表和一组约束
    - D. 一个系统和一组连接件

    答案: C

|五大架构风格|子风格|
| ---- | ---- |
|数据流风格(Data Flow)|批处理(Batch Sequential)、管道-过滤器(Pipes and Filters)|
|调用/返回风格(Call/Return)|主程序/子程序(Main Program and Subroutine)、面向对象(Object-oriented)、分层架构(Layered System)|
|独立构件风格(Independent Components)|进程通信(Communicating Processes)、事件驱动系统（隐式调用）(Event system)|
|虚拟机风格(Virtual Machine)|解释器(interpreter)、规则系统(Rule-based System)|
|以数据为中心(Data-centered)|数据库系统(Database System)、黑板系统(Blackboard System)、超文本系统(Hypertext System)|

|架构风格|主要特点|主要优点|主要缺点|适合领域|
| ---- | ---- | ---- | ---- | ---- |
|管道-过滤器|过滤器相对独立|高内聚、低耦合；支持软件复用；可维护性、可扩展性较强；具有并发性、灵活性|不适于交互性强的应用，对于存在关系的数据流必须进行协调|系统可划分清晰的模块；模块相对独立；有清晰的模块接口|
|解释器风格|系统核心是虚拟机|自定义一套规则，开发构件，增加灵活性，能够跨平台|执行效率低，如果语法规则数量太多，会增加系统复杂度，性能较差|适合于模式匹配系统与语言编译器|
|面向对象|构件是对象，对象是通过函数和过程的调用 来交互的|高度模块化；实现封装；代码共享灵活；易维护；性能好|增加了对象之间的依赖关系|多种领域|
|事件系统|构件不直接调用一个过程，而是触发或广播一个或多个事件|支持软件复用；容易实现并发处理和多任务；可扩展性好；具有类层次结构；简化代码|对系统计算的控制能力弱，各个对象的逻辑关系复杂|一个系统对外部的表现可以从它对事件的处理表征出来|
|层次型|构件组成一个层次结构；多层相互协同工作，每一层为上层提供服务，并作为下层的客户，只对与自己相邻的层可见|支持系统设计过程中的逐级抽象；可扩展性好；支持软件复用|不同层次之间耦合度高的系统很难实现，即难以划分层次|适合功能层次的抽象和相互之间低耦合的系统|
|仓库|由中央数据结构（说明当前数据状态）和一组独立构件（对中央数据进行操作）组成|中央数据结构实现了数据的集中，以数据为中心|适合于特定领域|以数据为中心|

## 数据流架构风格

数据流风格（Data Flow Style）将系统视为由一组处理单元（组件）和数据流动路径组成，数据通过组件进行处理并按顺序流动。这种架构风格适用于数据处理流程明确、步骤化的场景，例如批处理系统、编译器、信号处理等。主要包括批处理风格和管道-过滤器风格。

1. 优点

    1. 松耦合(高内聚 - 低耦合)
    2. 良好的重用性/可维护性
    3. 可扩展性(标准接口适配)
    4. 良好的隐蔽性
    5. 支持并行

2. 缺点

    1. 交互性较差
    2. 复杂性较高
    3. 性能较差（每个过滤器都需要解析与合成数据）

3. 典型实例

    - 传统编译器
    - 网络报文处理

4. 子数据流风格

    - 批处理序列：大量整体数据、无需用户交互
    - 管道过滤器：流式数据、弱用户交互

### 批处理风格

批处理风格(Batch Sequential)构件为一系列固定顺序的计算单元，构件之间只通过数据传递交互。每个处理步骤是一个独立的程序，每一步必须在其前一步结束后才能开始，数据必须是完整的，以整体的方式传递。构件是独立的应用程序，连接件是某种类型的媒介。

### 管道过滤器风格

管道过滤器风格(Pipe-Filter): 每个过滤器（处理步骤）都有一组输入和输出，过滤器从管道（数据传输）中读取输入的数据流，经过内部处理，产生输出数据流并写入管道中。前一个过滤器的输出作为后一个过滤器的输入，前后数据流关联。构件就是过滤器，连接件就是管道。早期编译器就是采用的这种架构，要一步一步处理的，均可考虑此架构风格。

二者区别在于批处理前后构件不一定有关联，并且是作为整体传递，即必须前一个执行完才能执行下一个。管道 - 过滤器是前一个输出作为后一个输入，前面执行到部分可以开始下一个的执行。

![alt text](软件架构设计/7.png)

## 调用返回体系结构风格

调用返回风格(Call-and-Return Styles)是指在系统中采用了调用与返回机制。其主要思想是将一个复杂的大系统分解为若干子系统，以便降低复杂度，并且增加可修改性。构件之间存在互相调用的关系，一般是显式的调用，主要包括主程序子程序风格、面向对象风格、层次型风格、客户端服务器风格以及浏览器服务器体系结构风格。

![alt text](软件架构设计/8.png)

优点：

- 良好的重用性，只要接口不变可用在其它处
- 可维护性好
- 可扩展性好，支持递增设计

缺点：

- 并不是每个系统都方便分层
- 很难找到一个合适的、正确的层次抽象方法
- 不同层次之间耦合度高的系统很难实现

### 主程序/子程序风格

主程序 - 子程序（Main Program-Subroutine）: 采用单线程控制，把问题划分为若干个处理步骤，构件即为主程序和子程序，子程序通常可合成为模块。过程调用作为交互机制，充当连接件的角色。

```python
# 主程序
def main():
    while True:
        print("\n学生成绩管理系统")
        print("1. 录入学生信息")
        print("2. 计算平均分")
        print("3. 打印成绩报表")
        print("4. 退出系统")
        choice = input("请选择功能：")
        
        if choice == "1":
            input_data()  # 调用录入信息子程序
        elif choice == "2":
            calculate_avg()  # 调用计算平均分子程序
        elif choice == "3":
            print_report()  # 调用打印报表子程序
        elif choice == "4":
            exit_system()  # 调用退出子程序
        else:
            print("无效选择，请重新输入！")

# 子程序1：录入学生信息
def input_data():
    global students  # 简化示例，使用全局变量存储数据
    students = []
    n = int(input("请输入学生人数："))
    for i in range(n):
        name = input(f"输入第{i+1}个学生姓名：")
        score = float(input(f"输入{name}的成绩："))
        students.append({"姓名": name, "成绩": score})
    print("信息录入完成！")

# 子程序2：计算平均分
def calculate_avg():
    global students
    if not students:
        print("请先录入学生信息！")
        return
    total = sum(student["成绩"] for student in students)
    avg = total / len(students)
    print(f"平均分：{avg:.2f}")

# 子程序3：打印成绩报表
def print_report():
    global students
    if not students:
        print("请先录入学生信息！")
        return
    print("\n学生成绩报表：")
    print("姓名\t成绩")
    for student in students:
        print(f"{student['姓名']}\t{student['成绩']}")

# 子程序4：退出系统
def exit_system():
    print("退出系统，感谢使用！")
    exit()

# 运行主程序
if __name__ == "__main__":
    students = []  # 初始化全局数据
    main()
```

### 面向对象风格

构件是对象，或者说是抽象数据类型的实例，连接件是对象间交互的方式。对象是通过函数和过程的调用来交互的。

### 层次型体系结构风格

构件组成一个层次结构，连接件通过决定层间如何交互的协议来定义。每一层为上层提供服务，并作为下层的客户，只对与自己相邻的层可见。修改某一层，最多影响其相邻的两层（通常只能影响上层）。

- 层次型结构优点：

    - 支持基于可增加抽象层的设计，允许将一个复杂问题分解成一个增量步骤序列的实现。
    - 不同的层次处于不同的抽象级别，越靠近底层，抽象级别越高。
    - 每一层最多只影响两层，为软件复用提供了强大的支持。

- 层次型结构缺点：

    - 并不是每个系统都可以很容易地划分为分层的模式。
    - 很难找到一个合适的、正确的层次抽象方法。

### 客户端/服务器体系结构风格

C/S（客户端/服务器）软件体系结构是基于资源不对等，且为实现共享而提出的。两层C/S体系结构有3个主要组成部分：数据库服务器、客户应用程序和网络。服务器（后台）负责数据管理，客户机（前台）完成与用户的交互任务，称为“胖客户机，瘦服务器”。

与两层C/S结构相比，三层C/S结构增加了一个应用服务器。整个应用逻辑驻留在应用服务器上，只有表示层存在于客户机上，故称为“瘦客户机”。应用功能分为表示层、功能层和数据层三层。表示层是应用的用户接口部分，通常使用图形用户界面；功能层是应用的主体，实现具体的业务处理逻辑；数据层是数据库管理系统。以上三层逻辑上独立。表示层在客户机上，功能层在应用服务器上，数据层在数据库服务器上。

![alt text](软件架构设计/0_3.png)

### 浏览器/服务器体系结构风格

B/S架构是三层C/S架构的变种，将客户端变为用户客户端上的浏览器，将应用服务器变为网络上的WEB服务器，又称为零客户端架构。其三层结构为：浏览器、Web服务器和数据库服务器。虽然不用开发客户端，但有很多缺点：

- 对动态页面的支持能力较弱，没有集成有效的数据库处理功能
- 安全性难以控制；
- 在数据查询等响应速度上，要远远低于C/S架构
- 数据提交一般以页面为单位，数据的动态交互性不强，不利于OLTP应用

## 以数据为中心的体系结构风格

以数据为中心的体系结构以数据为中心，所有的操作都是围绕建立的数据中心进行的，主要包括仓库体系结构风格和黑板体系结构风格。

### 仓库体系结构风格

仓库（Repository）是存储和维护数据的中心场所。仓库架构风格由中央数据结构（说明当前数据状态）和一组独立构件（对中央数据进行操作）组成。连接件是仓库与独立构件之间的交互。

![alt text](软件架构设计/0_4.png)

### 黑板体系结构风格

黑板体系结构风格（Blackboard Architecture Style）通过一个共享的中央数据结构（称为 “黑板”）来协调多个独立的处理单元（称为 “知识源”），各知识源通过读写黑板上的数据进行间接交互，共同完成问题的求解。这种风格常用于人工智能、专家系统、语音识别、图像分析等领域。

典型实例：

- 语音识别
- 模式识别
- 图像处理
- 知识推理

![alt text](软件架构设计/0_5.png)

## 虚拟机体系结构风格

虚拟机体系结构风格（Virtual Machine Architecture Style）是一种通过在`物理硬件`或`软件`层之上构建`抽象层`，`模拟`另一种`计算机系统`（如不同指令集、操作系统或运行环境）的架构模式，主要包括解释器风格和规则系统风格。

![alt text](软件架构设计/10.png)

### 解释器体系结构风格

解释器体系结构风格（Interpreter Architecture Style）是一种通过`实时分析和执行代码`（或指令）来实现程序运行的架构模式。其核心思想是利用一个`解释器`组件将`源代码`（或中间表示）`逐行转换`为目标系统的操作，而不是像编译器那样一次性生成可执行文件。这种风格常用于动态编程语言、脚本语言、配置语言或领域特定语言（DSL）中，强调灵活性和即时执行能力。

![alt text](软件架构设计/11.png)

### 规则系统体系结构风格

规则系统体系结构风格（Rule-Based System Architecture Style）是一种基于规则（Rule）和事实（Fact）的逻辑推理模型，通过定义 “条件 - 动作”（If-Then）规则来描述系统行为，并根据实时数据（事实）自动触发规则执行。核心组成部分包括: `规则库`, `工作内存`, `推理引擎`. 这种风格常用于需要处理复杂逻辑判断、业务规则频繁变更或需要模拟人类决策过程的场景，如专家系统、业务流程自动化、网络安全策略等。

![alt text](软件架构设计/12.png)

## 独立构件体系结构风格

独立构件体系结构风格（Independent Component Architecture Style）主要强调构件之间是互相独立的，不存在显式的调用关系，而是通过某个事件触发、异步的方式来执行，以降低耦合度，提升灵活性。主要包括进程通信和事件系统风格（隐式调用）。

![alt text](软件架构设计/9.png)

优点

- 松耦合
- 良好的重用性/可修改性/可扩展性

缺点

- 构件放弃了对系统计算的控制。一个`.*?` 构件触发一个事件时，不能确定其他构件是否会响应它。而且即使它知道事件注册了哪些构件的过程，也不能保证这些过程被调用的顺序
- 数据交换的问题
- 既然过程的语义必须依赖于被触发事件的上下文约束，关于正确性的推理就存在问题

特点

- 系统由若干子系统构成且成为一个整体；系统有统一的目标
- 子系统有主从之分
- 每一子系统有自己的事件收集和处理机制

### 进程通信体系结构风格

进程通信（Inter-Process Communication, IPC）体系结构风格关注的是如何在不同进程间实现安全、高效的数据交换和协调。在分布式系统、微服务架构或多进程应用中，进程通信是构建系统的基础，其设计模式直接影响系统的性能、可扩展性和可靠性。

|场景|适合的IPC模式|理由|
|--|--|--|
|同一主机内大数据量交换|共享内存|避免数据复制，性能最优|
|跨主机可靠通信|TCP套接字、RPC|确保数据完整传输|
|实时数据流处理|UDP套接字、消息队列（如Kafka）|低延迟，支持高吞吐量|
|命令行工具间协作|管道|简单高效，适合单向数据流|
|微服务间调用|RESTAPI（HTTP）、gRPC|标准化接口，支持异构系统集成|
|事件驱动的异步处理|消息队列（如RabbitMQ）|解耦生产者和消费者，支持流量削峰|

### 事件驱动体系结构风格

事件驱动体系结构风格（Event-Driven Architecture, EDA） 是一种基于 事件通信 的软件设计模式，核心思想是通过 事件的产生、检测、消费和响应 来实现组件间的解耦与协作。

## C2体系结构风格

C2(Component and Connector)体系结构风格可以概括为，通过连接件绑定在一起按照一组规则运作的并行构件网络。C2风格中的系统组织规则如下：

1. 系统中的构件和连接件都有一个顶部和一个底部
2. 构件的顶部应连接到某连接件的底部，构件的底部则应连接到某连接件的顶部，而构件与构件之间的直接连接是不允许的
3. 一个连接件可以和任意数目的其他构件和连接件连接
4. 当两个连接件进行直接连接时，必须由其中一个的底部到另一个的顶部

![alt text](软件架构设计/15.png)

## 闭环控制架构(过程控制)

![alt text](软件架构设计/14.png)

1. 适用于嵌入式系统，能够解决简单的闭环控制问题。
2. 经典应用场景包括空调温控、定速巡航 。

## 🔒题目

1. Java程序可以做到“一次编写，到处运行”，从架构风格上看符合（  ）风格的特点。虚拟机风格

2. 在网络通信中，进行包的解析，一般先进行包头的分离，然后进行报文解析及后续处理，根据这一特点，选用（ ）风格最合适。数据流

3. 某公司欲开发一个基于图形用户界面的集成调试器。该调试器的编辑器和变量监视器可以设置调试断点。当调试器在断点处暂停运行时，编辑程序可以自动卷屏到断点，变量监视器刷新变量数值。针对这样的功能描述，采用（  ）的架构风格最为合适。事件驱动

4. 某游戏公司欲开发一个大型多人即时战略游戏，游戏设计的目标之一是能够支持玩家自行创建战役地图，定义游戏对象的行为和之间的关系。针对该目标，公司应该采用（  ）架构风格最为合适。解释器

5. 某公司承接了一个开发家用空调自动调温器的任务，调温器测量外部空气温度，根据设定的期望温度控制空调的开关。根据该需求，公司应采用（  ）架构风格最为合适。过程控制

6. 某公司欲开发一个语音识别系统，语音识别的主要过程包括分割原始语音信号、识别音素、产生候选词、判定语法片断、提供语义解释等。每个过程都需要进行基于先验知识的条件判断并进行相应的识别动作。针对该系统的特点，采用（  ）架构风格最为合适。 黑板

7. 某公司欲开发一个漫步者机器人，用来完成火星探测任务。机器人的控制器首先定义探测任务和任务之间的时序依赖性，机器人接受任务后，需要根据自身状态和外界环境进行动态调整，最终自动完成任务。针对这些需求，该机器人应该采用（ ）架构风格最为合适。 解释器

8. Windows操作系统在图形用户界面处理方面采用的核心架构风格是（  ）风格。事件驱动

9. “编译器”是一种非常重要的基础软件，其核心功能是对源代码形态的单个或一组源程序依次进行预处理、词法分析、语法分析、语义分析、代码生成、代码优化等处理，最终生成目标机器的可执行代码。考虑以下与编译器相关的软件架构设计场景：

    传统的编译器设计中，上述处理过程都以独立功能模块的形式存在，程序源代码作为一个整体，依次在不同模块中进行传递，最终完成编译过程。针对这种设计思路，传统的编译器采用( )架构风格比较合适。

    随着编译、链接、调试、执行等开发过程的一体化趋势发展，集成开发环境（IDE）随之出现。IDE集成了编译器、连接器、调试器等多种工具，支持代码的增量修改与处理，能够实现不同工具之间的信息交互，覆盖整个软件开发生命周期。针对这种需求，IDE采用( )架构风格比较合适。IDE强调交互式编程，用户在修改程序代码后，会同时触发语法高亮显示、语法错误提示、程序结构更新等多种功能的调用与结果呈现，针对这种需求，通常采用( )架构风格比较合适。

    某公司已经开发了一款针对某种嵌入式操作系统专用编程语言的IDE，随着一种新的嵌入式操作系统上市并迅速占领市场，公司决定对IDE进行适应性改造，支持采用现有编程语言进行编程，生成符合新操作系统要求的运行代码，并能够在现有操作系统上模拟出新操作系统的运行环境，以支持代码调试工作。针对上述要求，为了使IDE能够生成符合新操作系统要求的运行代码，采用基于( )的架构设计策略比较合适；为了模拟新操作系统的运行环境，通常采用( )架构风格比较合适。

    - (1) A. 管道-过滤器  
    - B. 顺序批处理
    - C. 过程控制  
    - D. 独立进程  
    - (2) A. 规则引擎  
    - B. 解释器  
    - C. 数据共享  
    - D. 独立构件  
    - (3) A. 隐式调用  
    - B. 显式调用  
    - C. 主程序-子程序  
    - D. 层次结构  
    - (4) A. 代理  
    - B. 适配  
    - C. 包装  
    - D. 模拟  
    - (5) A. 隐式调用  
    - B. 仓库结构  
    - C. 基于规则  
    - D. 虚拟机

    答案: 1B, 2C, 3A, 4B, 5D

10. 💚软件体系结构风格是描述某一特定应用领域中系统组织方式的惯用模式。其中，在批处理风格软件体系结构中，每个处理步骤是一个单独的程序，每一步必须在前一步结束后才能开始，并且数据必须是完整的，以______的方式传递，基于规则的系统包括规则集、规则解释器、规则/数据选择器及______。

    - A. 迭代
    - B. 整体
    - C. 统一格式
    - D. 递增

    - A. 解释引擎
    - B. 虚拟机
    - C. 数据
    - D. 工作内存

    答案: B D


11. ❤️软件架构风格是描述某一特定应用领域中系统组织方式的惯用模式，按照软件架构风格，物联网系统属于 （  ） 软件架构风格。

    - A. 层次型
    - B. 事件系统
    - C. 数据线
    - D. C2

    - 答案：A 




12. 某软件公司为新推出的字处理软件设计了一种脚本语言，用于开发该软件的附加功能插件。为提高该语言编程效率，软件工具开发部门要为其研制一套集成开发环境。

    经对字处理软件特点分析，得出集成开发环境的3项核心需求：

    1. 需支持脚本语言的编辑、语法检查、解释、执行和调试等功能，且能灵活组合、配置与替换这些功能。

    2. 要提供一组可视化编程界面，让用户通过拖拽界面元素和填充代码完成功能插件核心业务流程编写与组织。

    3. 在代码调试方面，要在脚本语言编辑界面实现代码自动定位，即响应调试断点命中事件，自动跳转到对应代码处。

    针对这些需求，王工认为应采用管道-过滤器架构风格，李工认为应采用以数据存储为中心的架构风格。公司组织专家评审后，最终采用了李工的方案。

    4. 💛(问题1)请用200字以内的文字解释什么是软件架构风格，并从集成开发环境与用户的交互方式、集成开发环境的扩展性、集成开发环境的数据管理三个方面说明为什么最终采用了李工的设计方案。

        软件架构风格是指描述特定软件系统组织方式的惯用模式。组织方式描述了系统的组成构件和这些构件的组织方式，惯用模式则反映众多系统共有的结构和语义。

        从集成开发环境与用户的交互方式来看，用户通常采用交互式的方式对脚本语言进行编辑、解释执行与调试，以数据存储为中心的架构风格能很好地支持交互式数据处理，而管道-过滤器架构风格对其支持有限。

        从集成开发环境的扩展性来看，系统核心需求要求实现多种功能的灵活组织、配置与替换。以数据存储为中心的架构风格，可通过数据格式解耦各功能间的依赖关系，还能灵活定义功能间的逻辑顺序；管道-过滤器架构风格在解耦数据处理过程依赖关系上类似，但在灵活定义数据处理逻辑关系方面较差。

        从集成开发环境的数据管理来看，其需要支持多种数据类型和数据格式转换。以数据存储为中心的架构将数据存储在统一的中心存储器中，能表示多种数据格式并提供转换支持；管道-过滤器架构风格通常只能支持有限的数据格式，在数据格式转换上灵活性欠佳 。

        ✨根据题干内容答即可

    5. ❤️(问题2)在对软件系统架构进行设计时，要对架构需求进行分析，针对特定需求选择最为合适的架构风格，因此实际的软件系统通常会混合多种软件架构风格。请对核心需求进行分析，说明为了满足需求（2）和（3），分别应采用何种架构风格，并概要说明采用相应架构风格后的架构设计过程。

        为了满足需求（2），应该采用解释器架构风格。具体来说，需要：

        1. 为可视化编程元素及其拖拽关系定义某种语言，并描述其语法与语义；
        2. 编写解释器对该语言进行解释；
        3. 生成对应的脚本语言程序。

        为了满足需求（3），应该采用隐式调用架构风格。具体来说：

        首先需要定义“断点在调试过程中命中”这一事件，并实现当断点命中后的屏幕定位函数。集成开发环境维护一个事件注册表结构，将该事件与屏幕定位函数关联起来形成注册表中的一个记录项。在调试过程中，集成开发环境负责监听各种事件，当“断点在调试过程中命中”这一事件发生时，集成开发环境查找事件注册表，找到并调用屏幕定位函数，从而实现脚本语言编辑界面与调试代码的自动定位。

13. 某电子商务公司拟升级其会员与促销管理系统，向用户提供个性化服务，提高用户的粘性。在项目立项之初，公司领导层一致认为本次升级的主要目标是提升会员管理方式的灵活性，由于当前用户规模不大，业务也相对简单，系统性能方面不做过多考虑，新系统除了保持现有的四级固定会员制度外，还需要根据用户的消费金额、偏好、重复性等相关特征动态调整商品的折扣力度，并支持在特定的活动周期内主动筛选与活动主题高度相关的用户集合，提供个性化的打折促销活动。

    1. (13分)针对该系统的功能，李工建议采用面向对象的架构风格，将折扣力度计算和用户筛选分别封装为独立对象，通过对象调用实现对应的功能；王工则建议采用解释器(interpreters)架构风格，将折扣力度计算和用户筛选条件封装为独立的规则，通过解释规则实现对应的功能。请针对系统的主要功能，从折扣规则的可能改性、个性化折扣定义灵活性和系统性能三个方面对这两种架构风格进行比较与分析，并指出该系统更适合采用哪种架构风格。(2022下)

    应该选择解释器架构风格。

    - 折扣规则的可修改性：解释器风格比面向对象方式实现强。因为解释器风格折扣规则是独立的语法规则，由解释器可以对变化的规则进行解析，修改更容易。而面向对象相对固定，有变化时需要修改具体的类。

    - 个性化折扣定义灵活性：解释器强于面向对象，解释器可以根据用户灵活解释执行规则，做到千人千面。

    - 系统性能：面向对象优于解释器。面向对象的实现相对固定，而解释器是运行期动态绑定执行。
    （面向对象风格：效率高，质量高，易维护，灵活性稍差，性能好；解释器风格：可修改性高，个性化和灵活性强，性能较差。）

    由于本项目的目标是提升灵活性，并且业务简单，系统性能方面不做过多考虑，因此建议采用解释器风格。

14. 某公司拟开发一套机器学习应用开发平台，支持用户使用浏览器在线进行基于机器学习的智能应用开发活动。该平台的核心应用场景是用户通过拖拽算法组件灵活定义机器学习流程，采用自助方式进行智能应用设计、实现与部署，并可以开发新算法组件加入平台中。

    1. （16分）针对该系统的功能，赵工建议采用解释器(interpreter)架构风格，李工建议采用管道-过滤器(pipe - and - filter)的架构风格，王工则建议采用隐式调用(implicit invocation)架构风格。请针对平台的核心应用场景，从机器学习流程定义的灵活性和学习算法的可扩展性两个方面对三种架构风格进行对比与分析，并指出该平台更适合采用哪种架构风格。 (2021下)

        应该选择解释器架构风格。

        - 灵活性：解释器可以通过灵活的自定义规则实现规则的重组。
        - 可扩展性：解释器可以包括一个完成解释工作的解释引擎、一个包含将被解释的代码的存储区、一个记录解释引擎当前工作状态的数据结构，以及一个记录源代码被解释执行的进度的数据结构。可以通过新建规则实现可扩展性。

        管道 - 过滤器风格具备高内聚低耦合、支持软件重用、扩展性好、支持并发等优点，但它有编写复杂、不适合处理交互应用等缺点。

        隐式调用基于事件触发思想，具备支持软件重用、改进系统方便等优点，但它有构件放弃了对系统计算的控制、事件传递中的数据交换存在问题、语义依赖于被触发事件的上下文约束等缺点。

        解释器通常包括解释引擎、代码存储区、记录解释引擎当前工作状态的数据结构、记录源代码被解释执行进度的数据结构。它含有一个虚拟机，可以仿真硬件的执行过程和一些关键应用，其缺点是执行效率比较低。优点：语法由很多类（每个规则对应一个类）表示，容易改变及扩展；缺点：如果语法规则数量太多，会增加系统复杂度，性能下降。

        本题中，由于需要交互操作，显然管道 - 过滤器风格不合适；基于事件触发的隐式调用风格也不合适；只有解释器风格通过灵活自定义规则，具备较强的灵活性和可扩展性，适合本题中的机器学习应用场景。

15. 某公司拟开发一套在线软件开发系统，支持用户通过浏览器在线进行软件开发活动。该系统的主要功能包括代码编辑、语法高亮显示、代码编译、系统调试、代码仓库管理等。

    1. （13分）针对该系统的功能，李工建议采用管道 - 过滤器（pipe and filter）的架构风格，而王工则建议采用仓库（repository）架构风格。请指出该系统更适合采用哪种架构风格，并针对系统的主要功能，从数据处理方式、系统的可扩展性和处理性能三个方面对这两种架构风格进行比较与分析，填写表1 - 1中的（1）～（4）空白处。 (2020下)

        |架构风格名称|数据处理方式|系统可扩展性|处理性能|
        | ---- | ---- | ---- | ---- |
        |管道 - 过滤器|数据驱动机制，处理流程事先确定，交互性差|（2）|劣势：需要数据格式转换，性能降低<br>优势：支持过滤器并发调用，性能提高|
        | 仓库 | （1） | 数据与处理解耦合，可动态添加和删除处理组件 | 劣势：（3）<br>优势：（4）|

        根据该系统的功能需求，采用仓库架构风格更合适。
        1. 数据统一保存在中央数据仓库，数据处理流程相对独立，支持交互式处理。
        2. 管道过滤器风格容易添加新的过滤器，可扩展性好。
        3. 仓库风格不支持并行，效率低。
        4. 仓库风格容错性和健壮性好。

        答案解析：管道过滤器架构风格由一系列处理单元（过滤器）组成，每个单元的输出是下一个单元的输入。过滤器负责处理数据，管道负责数据传输。如Linux/Unix中的shell、传统的编译器就是管道过滤器风格。
        优点：
        ①高内聚，过滤器是执行特定功能的处理服务，具有较强的内聚性；
        ②低耦合，过滤器之间仅通过管道通信；
        ③可重用，支持过滤器的重用；
        ④能简单地实现并发或顺序系统；
        ⑤可扩展性，容易添加新的过滤器；
        ⑥灵活性，过滤器功能可重新定义，管道路线可改变。
        缺点：
        ①管道中数据传输需要通用的标准；
        ②难以支持基于事件的交互。

        仓库风格是一种数据共享风格，主要有两类，一是传统的数据库，另一是黑板。数据库系统是由输入流中的事件来驱动信息处理，把执行结构存储到中央数据单元。黑板则由中央数据单元的当前状态来驱动系统运行，用来解决状态冲突并处理可能存在的不确定性知识源。黑板常用信号处理，如语音识别、模式识别、机器翻译、句法分析等。
        优点：
        ①便于多客户共享大量数据，不必关心数据的产生、有谁提供、如何提供等；
        ②便于将构件作为知识源添加到系统中来；
        ③解决问题的多方法性；
        ④具有可修改性和可维护性；
        ⑤有可重用的知识源；
        ⑥支持容错性和健壮性。
        缺点：
        ①对共享数据结构，不同知识源要达成一致；
        ②需要同步机制、加锁机制来保障数据的完整性和一致性，增大了系统设计的复杂度；
        ③测试困难；
        ④缺少对并行机的支持，效率低；
        ⑤开发成本高。

        题干的系统功能包括代码编辑、语法高亮显示、代码编译、系统调试、代码仓库管理等。这些功能相对独立，代码通过中央数据单元存储，各个功能彼此之间不依赖，采用仓库风格更合适。
