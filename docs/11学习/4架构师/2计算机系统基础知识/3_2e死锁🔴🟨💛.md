# 死锁

## 最佳实践

### 考试总结



3. (✨2025上)操作系统中有5个进程，若每个进程最多可同时访问2个资源，为了不发生死锁，至少需要提供( )个资源。

    - A.6
    - B.5
    - C.8
    - D.10

    答案: A


1. 🟨假设系统中有三类互斥资源R₁、R₂、R₃，可用资源数分别为8、7和4。在T₀时刻系统中有P₁、P₂、P₃、P₄、P₅这5个进程，这些进程对资源的最大需求量和已分配资源数如下表所示。

    |进程|最大需求量(R₁ R₂ R₃)|已分配资源数(R₁ R₂ R₃)|
    | ---- | ---- | ---- |
    |P₁|6 4 2|1 1 1|
    |P₂|2 2 2|2 1 1|
    |P₃|8 1 1|2 1 0|
    |P₄|2 2 1|1 2 1|
    |P₅|3 4 2|1 1 1|

    若有如下4个执行序列，那么进程按_____序列执行，系统状态是安全的。

    - A. P₁ → P₂ → P₄→ P₅→ P₃
    - B. P₂ → P₁ → P₄→ P₅→ P₃
    - C. P₄ → P₂ → P₁→ P₅→ P₃
    - D. P₄ → P₂ → P₅→ P₁→ P₃

    答案: D

    |进程/资源|最大需求量(R₁ R₂ R₃)|已分配资源数(R₁ R₂ R₃)|还需要资源数(R₁ R₂ R₃)|
    | ---- | ---- | ---- | ---- |
    |P₁| 6 4 2|1 1 1|5 3 1|
    |P₂| 2 2 2|2 1 1|0 1 1|
    |P₃| 8 1 1|2 1 0|6 0 1|
    |P₄| 2 2 1|1 2 1|1 0 0|
    |P₅| 3 4 2|1 1 1|2 3 1|
    |已分配总数||7 6 4|
    |剩余资源数||1 1 0|

2. 🟨假设系统中互斥资源R的可用数为25。T0时刻进程P1、P2、P3、P4对资源R的最大需求数、已分配资源数和尚需资源数的情况如表1所示，若P1和P3分别申请资源R数为1和2，则系统(  )。表1 T0时刻进程对资源的需求情况

    |进程|最大需求数|已分配资源数|尚需资源数|
    | ---- | ---- | ---- | ---- |
    |P1|10|6|4|
    |P2|11|4|7|
    |P3|9|7|2|
    |P4|12|6|6|

    - A. 只能先给P1进行分配，因为分配后系统状态是安全的
    - B. 只能先给P3进行分配，因为分配后系统状态是安全的
    - C. 可以同时给P1、P3进行分配，因为分配后系统状态是安全的
    - D. 不能给P3进行分配，因为分配后系统状态是不安全的

    答案: B




### 考察问


1. 死锁的概念: 进程因`()`而陷入`()`的现象
2. n个进程, 每个进程需R个资源, 则死锁的可能发生资源范围`()`
3. 死锁资源计算

    系统内有n个进程，每个进程都需要R个资源，那么

    1. 必然发生死锁的资源数为`()`
    2. 可能发生死锁的资源数为`()`
    3. 不可能发生死锁的资源数为`()`

    ✨只需记住可能发生死锁的资源闭区间个数即可


2. 不发生死锁的最佳执行路径
    1. 先计算每个`()`
    2. 再计算目前各个`()`
    3. 剩余资源数有限`()`需要资源数的进程

### 考察点

1. 死锁的概念: 进程因`争夺对方占用的资源`而陷入`无限等待`的现象
2. n个进程, 每个进程需R个资源, 则死锁的可能发生资源范围`[R, n * (R – 1)]`
3. 死锁资源计算

    系统内有n个进程，每个进程都需要R个资源，那么

    1. 必然发生死锁的资源数为`<R`
    2. 可能发生死锁的资源数为`[R, n * (R – 1)]`
    3. 不可能发生死锁的资源数为`> n * (R – 1)`

    ✨只需记住可能发生死锁的资源闭区间个数即可


2. 不发生死锁的最佳执行路径
    1. 先计算每个`进程还需要的资源数`
    2. 再计算目前各个`资源剩余的个数`
    3. 剩余资源数有限`填补最小`需要资源数的进程


## 死锁概念

死锁，是指两个以上的进程因`争夺对方占用的资源`而陷入`无限等待`的现象

## 死锁的四大条件

1. 互斥(资源互斥)
2. 保持和等待(进程占有资源并等待其他资源)
3. 不可剥夺(系统不可剥夺进程资源)
4. 环路(进程资源是一个环路)

![alt text](./3计算机软件概述/死锁.png)

## 死锁的处理策略

1. 死锁预防：采用某种策略限制并发进程对资源的请求，破坏死锁产生的4个必要条件，使系统在任何时刻都不满足产生死锁的必要条件。
2. 死锁避免：提前计算出一条不会产生死锁的资源分配方法。著名的死锁避免算法有银行家算法。
3. 死锁检测：允许死锁产生，但系统定时运行一个死锁检测程序，判断系统是否发生死锁，若检测到有死锁，则设法加以解除。
4. 死锁解除：即死锁发生后的解除方法，如资源剥夺法、撤销进程法等。

## 死锁资源计算

系统内有n个进程，每个进程都需要R个资源，那么

1. 必然发生死锁的资源数为`<R`
2. 可能发生死锁的资源数为`[R, n * (R – 1)]`
3. 不可能发生死锁的资源数为`> n * (R – 1)`


🔒系统有 3 个进程：A、B、C。这 3 个进程都需要 5 个系统资源。如果系统至少有多少个资源，则不可能发生死锁。

![alt text](./3计算机软件概述/死锁资源的计算.png)

1. 当`R<=4`个资源时, 一定会发生死锁, 既资源全给一个进程也不满足
2. 当`R = [5, 12]`个资源时, 可能会发生死锁(5是一个进程需要的最少资源, 12是进程数 x 每个进程需要的资源-1), 只要资源先给一个资源, 就不会发生死锁; 如果均分则发生死锁
3. 当`R >= 13`个资源时, 一定不会发生死锁. 资源全给一个进程, 或者均分都不会发生死锁

