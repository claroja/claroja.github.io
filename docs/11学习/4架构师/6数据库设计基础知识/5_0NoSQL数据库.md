# NoSQL数据库

NoSQL 最常见的解释是 Non-Relational, Not  Only SQL 也被很多人接受。 NoSQL 仅仅是一个概念，泛指非关系型的数据库，区别于关系数据库，它们不保证关系数据的 ACID 特性。



## 分类与特点


1. 列式存储数据库

    键仍然存在，但是它们的特点是指向了多个列。这些列是由列家族来安排的。现有产品如 Cassandra 、 HBase 、 Riak 。

2. 键值对存储数据库

    键值存储的典型数据结构一般为数组链表：先通过 Hash 算法得出 Hashcode, 找到数组的某一个位置，然后插入链表。

    这类数据库主要会用到一个哈希表，表中有一个特定的键和一个指针指向特定的数据。Key-value 模型对于 IT 系统来说，其优势在千简单、易部署。但是如果数据库管理员只对部分值进行查询或更新的时候， Key-value 就显得效率低下了。现有产品如 Tokyo Cabi net/Tyrant、Redis 、 Voldemort、 Oracle BDB 。

3. 文档型数据库

    文档型数据库可以看作是键值数据库的升级版，允许嵌套键值，在处理网页等复杂数据时，文档型数据库比传统键值数据库的查询效率更高。现有产品如 CouchDB 、MongoDb, 国内也有文档型数据库 Sequoi aDB, 已经开源。

4. 图数据库

    NoSQL 数据库没有标准的查询语言(SQL), 因此进行数据库查询需要指定数据模型。许多 NoSQL 数据库都有 REST 式的数据接口或者查询 API 。适合存储通过图进行建模的数据，例如社交网络数据，生物信息网络数据，交通网络数据等。常见的产品有 Neo4J、InfoGri d 、 Infinite Graph 等。



✨总结:

|分类|典型应用场景|数据模型|优点|缺点|举例|
| ---- | ---- | ---- | ---- | ---- | ---- |
|键值(key-value)|内容缓存，主要用于处理大量数据的高访问负载，也用于一些日志系统等等|Key指向Value的键值对，通常用hash table来实现|查找速度快|数据无结构化，通常只被当作字符串或者二进制数据|Redis，Tokyo Cabinet，Tyrant，Voldemort，Oracle BDB|
|列存储数据库|分布式的文件系统|以列簇式存储，将同一列数据存在一起|查找速度快，可扩展性强，更容易进行分布式扩展|功能相对局限|HBase，Cassandra，Riak|
|文档型数据库|Web应用(与Key-Value类似，Value是结构化的，不同的是数据库能够了解Value的内容)|Key-Value对应的键值对，Value为结构化数据|数据结构要求不严格，表结构可变，不需要像关系型数据库一样需要预先定义表结构|查询性能不高，而且缺乏统一的查询语法|CouchDB，MongoDB|
|图形数据库(Graph)|社交网络，推荐系统等。专注于构建关系图谱|图结构|利用图结构相关算法，比如最短路径寻址，N度关系查找等|很多时候需要对整个图做计算才能得出需要的信息，而且这种结构不太好做分布式的集群方案|Neo4J，InfoGrid，Infinite Graph|




目前业界对于 NoSQL 并没有一个明确的范围和定义，但是它们普遍存在下面一些共同特征：

1. 易扩展：去掉了关系数据库的关系型特性。数据之间无关系，这样就非常容易扩展。
2. 大数据量，高性能： NoSQL数据库都具有非常高的读写性能，尤其在大数据量下。这得益于它的无关系性，数据库的结构简单。
3. 灵活的数据模型： NoSQL无须事先为要存储的数据建立字段，随时可以存储自定义的数据格式。
4. 高可用： NoSQL在不太影响性能的情况下，就可以方便地实现高可用的架构，有些产品
通过复制模型也能实现高可用。

## 体系框架

NoSQL 整体框架分为 4 层，由下至上分为数据持久层 (Data Persi stence) 、数据分布层(Da ta Distribution Model) 、数据逻辑模型层( Data Logical Model) 和接口层 (Interface)。

1. 数据持久层定义了数据的存储形式，主要包括基千内存、硬盘、内存和硬盘接口、订制可插拔 4 种形式。基于内存形式的数据存取速度最快，但可能会造成数据丢失；基于硬盘的数据存储可能保存很久，但存取速度慢千基千内存形式的数据；内存和硬盘相结合的形式，结合了前两种形式的优点，既保证了速度，又保证了数据不丢失；订制可插拔则保证了数据存取具有较高的灵活性。

2. 数据分布层定义了数据是如何分布的，相对千关系型数据库， NoSQL 可选的机制比较多，主要有 3 种形式：一是 CAP 支持，可用于水平扩展；二是多数据中心支待，可以保证在横跨多数据中心时也能够平稳运行；三是动态部署支待，可以在运行着的集群中动态地添加或删除结点。

3. 数据逻辑层表述了数据的逻辑表现形式。
4. 接口层为上层应用提供了方便的数据调用接口，提供的选择远多于关系型数据库。接口层提供了 5 种选择： Rest、 Thrift、 Map/Reduce 、 Get/Put、特定语言 API ，使得应用程序和数据库的交互更加方便。






## 数据类型比较(拓展)

### 基本概念

1. 关系型数据库：由多张能互相联接的二维行列表格组成的数据库。建立在关系模型基础上的数据库，借助集合代数等数学概念和方法来处理数据库中的数据。

2. NoSQL：泛指非关系型的数据库。为了解决大规模数据集合多重数据种类带来的挑战，尤其是大数据应用难题，包括超大规模数据的存储，如Mongodb、Redis、Hbase、neo4j、Cassandra等。


### 关系数据库模式与NoSQL模式的特征对比

| 特征 | 关系数据库模式 | NoSQL模式 |
| ---- | ---- | ---- |
| 并发支持 | 支持并发、效率低 | 并发性能高 |
| 存储与查询 | 关系表方式存储、SQL查询 | 海量数据存储、查询效率高 |
| 扩展方式 | 向上扩展 | 向外扩展 |
| 索引方式 | B树、哈希等 | 键值索引 |
| 应用领域 | 面向通用领域 | 特定应用领域 |
| 数据一致性 | 实时一致性 | 弱一致性 |
| 数据类型 | 结构化数据 | 非结构化 |
| 事物 | 高事务性 | 弱事务性 |
| 水平扩展 | 弱 | 强 |
| 数据容量 | 有限数据 | 海量数据 |

### 内存数据库与关系数据库的对比

|  | 内存数据库 | 关系数据库 |
| ---- | ---- | ---- |
| 主要数据模型 | Key - Value模式(键 - 值对模式) | 关系模式 |
| 读写性能 | 内存直接读写，性能相对较高 | 外存读写，性能相对较低 |
| 存储容量 | 基于内存存储，存储容量受限 | 基于存盘存储，存储容量大 |
| 可靠性 | 恢复机制复杂，可靠性较低 | 内建恢复机制，可靠性较高 |

### 关系型数据库与文件系统的对比

|  | 关系型数据库 | 文件系统 |
| ---- | ---- | ---- |
| 设计难度 | 针对特定应用系统设计，难度较大 | 针对特定应用系统设计，难度较小 |
| 数据冗余程度 | 遵守数据库范式，数据冗余较小 | 可能在多个文件中复制相同的数据属性，数据冗余较大 |
| 数据架构 | 以数据库为中心组织，管理数据 | 以应用为中心管理数据 |
| 应用扩展性 | 数据库独立于应用系统，数据库系统接口标准化，易于在不同应用之间共享数据 | 符合特定应用系统要求的文件数据很难在不同的应用系统之间共享 |