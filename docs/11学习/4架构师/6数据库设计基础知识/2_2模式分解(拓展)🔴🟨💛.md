
# 模式分解

## 最佳实践

### 考题总结

1. 无损连接: 将拆解的表还原
2. 保持函数依赖: 分解后的小表, 默认是后面的列依赖前面的列


### 考察问

1. 模式分解概念: (), 目的是()
2. 模式分解衡量指标: (), ()
3. 无损连接概念: () 关联 (), 是否能()
4. 保持函数依赖: 子关系的(), 包含了父关系的(). 

### 考察点

1. 模式分解: 将`一个`关系模式`分解`为`多个`子关系模式, 目的是使模式`规范化`.
2. 模式分解使用`无损连接`和`保持函数依赖`来衡量模式分解后是否导致原有模式中部分信息丢失。
3. 无损连接: 在`超类实体`关联`子类实体`, 看是否能还原
4. 保持函数依赖: 拆分后的子关系模式中的`属性集合`, 是否包含了父关系`依赖关系的属性`. 不要求父依赖关系的入度为0的必须是主键.


## 模式分解的概念

将一个关系模式分解为多个子关系模式, 目的是使模式规范化.

模式分解使用`无损连接`和`保持函数依赖`来衡量模式分解后是否导致原有模式中部分信息丢失。

## 无损连接分解

将一个关系模式分解成若干个关系模式后，通过自然联接和投影等运算仍能还原到原来的关系模式

🔒题目:

1. 有关系模式：成绩(学号，姓名，课程号，课程名，分数)

    函数依赖：学号→姓名，课程号→课程名，(学号，课程号)→分数

    若将其分解为：

    - 成绩(学号，课程号，分数)
    - 学生(学号，姓名)
    - 课程(课程号，课程名)

    请思考该分解是否为无损分解？

    分解后的子模式如下:

    |  | 学号 | 姓名 | 课程号 | 课程名 | 分数 |
    | ---- | ---- | ---- | ---- | ---- | ---- |
    | 成绩 | √ | × | √ | × | √ |
    | 学生 | √ | √ | × | × | × |
    | 课程 | × | × | √ | √ | × |

    方法: 在超类实体关联子类实体, 看是否能还原

    1. 查看成绩行
    2. 学号→姓名，对上表进行处理，把“×”改成符号“√”；
    3. 课程号→课程名，将“×”改为“√”

    得到下表：

    |  | 学号 | 姓名 | 课程号 | 课程名 | 分数 |
    | ---- | ---- | ---- | ---- | ---- | ---- |
    | 成绩 | √ | √ | √ | √ | √ |
    | 学生 | √ | √ | × | × | × |
    | 课程 | × | × | √ | √ | × |

    从上图中可以看出，第1行已全部为“√”，因此本次R分解是无损分解。

2. 某商场商品数据库的商品关系模式P(商品代码，商品名称，供应商，联系方式，库存量)，函数依赖集F = {商品代码→商品名称，(商品代码，供应商)→ 库存量，供应商→联系方式}。商品关系模式P达到(  )；该关系模式分解成(  )后，具有无损连接的特性，并能够保持函数依赖。

    - A. 1NF
    - B. 2NF
    - C. 3NF
    - D. BCNF

    - A. P1(商品代码，联系方式)，P2(商品名称，供应商，库存量)
    - B. P1(商品名称，联系方式)，P2(商品代码，供应商，库存量)
    - C. P1(商品代码，商品名称，联系方式)，P2(供应商，库存量)
    - D. P1(商品代码，商品名称)，P2(商品代码，供应商，库存量)，P3(供应商，联系方式)

    答案: AD

## 保持函数依赖

设数据库模式ρ={R1，R2，…，Rk}是关系模式R的一个分解，F是R上的函数依赖集，ρ中每个模式Ri上的依赖集是Fi。如果{F1，F2，…，Fk}与F是等价的(即相互逻辑蕴涵)，那么称分解ρ保持F的函数以来。

拆分后的子关系模式中的属性集合, 是否包含了父关系依赖关系的属性. 不要求父依赖关系的入度为0的必须是主键.


🔒题目:

1. 有关系模式R(A，B，C)，F = {A→B，B→C}，将其拆分为R1(A，B)，R2(B，C)，判断是否保持函数依赖。 是
2. 有关系模式R(A，B，C)，F = {A→B，B→C，A→C}，将其拆分为R1(A，B)，R2(B，C)，判断是否保持函数依赖。 是,  A→C是冗余关系
3. 有关系模式R(A，B，C)，F = {A→B，B→C，A→C}，将其拆分为R1(A，B)，R2(A，C)，判断是否保持函数依赖。否
4. 有关系模式R(A，B，C，D，E)，F = {A→B，D→E}，将其拆分为R1(A，B，C)，R2(D，E)，判断是否保持函数依赖。是
5. 给出关系R(U，F)，U = {A，B，C，D，E}，F = {A→BC，B→D，D→E}。以下关于F说法正确的是(  )。若将关系R分解为ρ = {R1(U1，F1)，R2(U2，F2)}，其中：U1 = {A，B，C}、U2 = {B，D，E}，则分解ρ(  )。

    - A. F蕴涵A→B、A→C，但F不存在传递依赖
    - B. F蕴涵E→A、A→C，故F存在传递依赖
    - C. F蕴涵A→D、E→A、A→C，但F不存在传递依赖
    - D. F蕴涵A→D、A→E、B→E，故F存在传递依赖

    - A. 无损连接并保持函数依赖
    - B. 无损连接但不保持函数依赖
    - C. 有损连接并保持函数依赖
    - D. 有损连接但不保持函数依赖

    答案: DA
