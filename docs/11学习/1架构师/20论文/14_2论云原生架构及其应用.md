# 论云原生架构及其应用


我们在项目中采用云原生架构，充分体现云原生架构的自动化、服务化、弹性，及可观测性四大原则。自动化原则，体现应用的自动发布，自动化代码检查，及自动化测试等自动流程；服务化原则，体现在云原生架构实现了“微服务，轻应用”，按需对外提供服务；弹性原则主要来源于云计算特有的对云资源的弹性伸缩能力；可观测性，通过相关采集系统和监测工具的使用，系统的可观测性进一步加强。接下来，我将基于本项目的实践着重论述自动化原则，服务化原则，及弹性原则。

一、自动化原则。以往的项目中上线一个应用，需要准备环境，搭建服务器，有时因为开发时没考虑上线时的需要，如浏览器及客户端等适配问题，经常导致上线工作周期长，问题多，经常返工。本项目中我们一方面采用了K8S来进行容器的编排和镜像的管理，基于容器技术实现了应用的自动化部署，及按需灵活缩扩容。为了实现自动化上线和自动运维，我在项目倡导了DevOps实践，开发人员从写下第一行代码开始，就要考虑相关后期上线及运维的工作，运维人员也在项目一开始就介入其中，使得从编码到上线更加顺畅高效。同时我也引入了相关自动代码检查，代码安全漏洞扫描工具，代替以往的人工走查和桌面检查，我们的测试团队也开发了相关自动测试工具，引入相关云服务商提供的自动压测工具，极大提升了团队的工作效率和项目质量。

二、服务化原则。以往系统建设中，多是竖井式建设，烟囱式系统，小而全，大而全，但工业互联网平台将要开发大量的工业应用，如果还是按照以前方式，一是工作量巨大，二是一定会有大量的重复建设，造成工期和成本的巨大浪费。项目中我们基于SOA的架构思想，采用现在流行的“微服务，轻应用”理念，采用spring cloud+docker的技术路线，我们将平台沉淀的相关设备管理、生产管理、供应链管理，及工业大数据分析能力拆分解耦，封装为一个个微服务，实现平台整体的“高内聚，低耦合”，这些服务通过微服务网关支撑各类上层工业应用服务建设，及工业app开发。通过这种方式，我们一方面实现了共性能力的复用，达到了集约化建设目标，另一方面也将平台能力通过微服务的方式开放给第三方开发者，将平台沉淀的相关数据分析，智能制造，设备管理能力对外赋能，为构建开放共享的区域工业互联网应用生态打下了坚实基础。

三、弹性原则。以往的系统平台建设中，如何按需对项目所需要的存储、计算、网络资源进行动态缩扩容，以及在面临海量高并发的情况下，如何能够实现应用服务的高可用性也是一直没有很好解决的难题。我通过打造两方面的能力，实现在云原生架构的区域工业互联网平台的弹性伸缩能力。为了解决这个问题，我们从三方面着手解决：一是在IaaS层通过VMware对存储，计算资源进行了虚拟化，构建了统一的虚拟化云资源池，并基于penStack打造了云资源服务统一管理平台，也就是区域工业云平台，基于OpenStack实现了云资源的弹性供给，动态管理，及按需缩扩容。二是在PaaS层通过K8S，实现根据服务请求数量，实时调整相关微服务数量，使用系统就算在高并发条件下也具有非常高的可用性，比如在实际使用中我们设备平台的协议转换服务请求较多时，通过k8s及时上线相关备用服务，满足忙时业务需求，当闲时也可以非常方便的下线相关应用服务，释放系统资源，提升了平台服务层的弹性。

xx年月项目正式上线运营，目前平台已经为区域内50多家工业企业提供上云服务，接入工业设备超200台，沉淀工业大数据近50PB，提供工业微服务近200个，打造了工业app近30个，初步构建了开放共享的区域工业互联网生态，取得了比较良好的社会效益和经济效益。




























