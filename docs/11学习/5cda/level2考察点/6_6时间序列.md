# 数据分析模型_时间序列


考纲:
- 领会
    - 时间序列分析原理
- 熟知
    - `时间序列分析的方法`
    - 明确`趋势分解法`、`ARMA方法`、ARIMA方法差异和适用场景
    - ARIMA方法的建模流程
- 应用
    - 结合业务（业绩预测、预警），选取合适的分析方法
    - 进行业务时间序列预测等模型的基本步骤与注意事项

分值:

- d.时间序列（占比 5%）


## 考点: 时间序列基本概念



- 🔴(单选题)以下各种背景下对产生自相关的原因描述错误的是？  
    A、经济系统的惯性产生序列的自相关  
    B、漏掉重要解释变量会产生序列的自相关  
    C、经济变量的滞后性会给序列带来自相关性  
    D、以上都不是

    正确答案：D, 解析：A项，经济系统的经济行为都具有时间上的惯性。例如：在经济高张时期，较高的经济增长率会持续一段时间，这种情况下经济数据很可能表现为自相关。B项在实际建模时，若忽略一个或多个重要解释变量，而这些漏掉的重要解释变量在时间顺序上具有一定的正相关关系，则回归模型中的随机误差项就包含了这些漏掉的重要变量，从而导致模型的随机误差项呈现明显的正相关现象。C项例如居民当期可支配收入的增加，不会使层民的消费水平在当期达到应有的水平。因为人的消费观点的改变存在一定的适应期，导致要经过若干期才能达到。这种时间上的滞后带来变量的自相关。


- 🔴(单选题)时间序列建模是通常要求序列满足（）  
    A、严平稳  
    B、宽平稳  
    C、非平稳  
    D、不平稳

    正确答案：B

- 🔴(单选题)时间序列分析中，以下哪个指标用于描述数据的趋势变化？  
    A、方差  
    B、标准差  
    C、均值  
    D、偏度

    正确答案：C

- 🟢(单选题)下列()是常见的时间序列算法模型。  
    A、RSI  
    B、MACD  
    C、ARMA  
    D、KNN  

    答案:C 


- 🔴(单选题)在对时间序列模型进行评估时，常用的方法是（）  
    A、判定系数  
    B、AUC值  
    C、残差白噪声检验  
    D、AIC准则

    正确答案：C, 在对时间序列模型进行评估时，常用的方法进行白噪声检验，若对应的残差序列是白噪声序列，则说明模型已经充分提取了数据信息，否则则说明模型没有充分提取数据信息。


## 考点: 平稳和非平稳时间序列分析方法

- 内容:

  - `平稳`时间序列模型`ARMA`和效应分解法
      1. 自回归模型(Auto Regression Model),即`AR`模型。
      2. 移动平均模型(Moving Average Model),即`MA`模型。
      3. 自回归移动平均模型(Auto Regression Moving Average Model),即`ARMA`模型。
  - `非平稳`时间序列模型`ARIMA`模型(差分的作用)和效应分解法

  > `效应分解法`, 既适合`平稳`时间序列又适合`非平稳`时间序列

- 题目: 

  - (单选题)在时间序列分析中，判断数据是否平稳的常用方法是（）  
    A、自相关系数图  
    B、偏自相关系数图  
    C、时序图  
    D、差分

    正确答案：C

## 效应分解法

### 考点: 时间序列的影响因素❤️


- 内容:

  - `趋势性`:是指序列朝着一定的方向持续上升或下降，或者停留在某个水平上的倾向。比如随着企业近段时间拓展业务，销售额稳步上升的趋势。
  - `周期性`(季节性和循环性):
    - `循环性`通常是现象在`较长时间`内呈现出的波浪式的起伏变动，比如GDP增长率随经济周期的变化而变化。
    - `季节性`变动是指季度、月度、周度、日度的周期变化，比如啤酒的销量在春季、夏季较高而在秋季、冬季较低。
  - `随机性`(不规则):随机变动是指由随机因素导致的时间序列的小幅度波动。


- 题目: 

  - 🟢(单选题)影响时间序列的因素不包括( )。  
      A、季节变动  
      B、循环波动  
      C、不规则波动  
      D、有效性

      答案:D 


  - 🟢(单选题)时间序列呈现出的以年为周期的固定变动模式，这种模式年复一年重复出现，我们称为()时间序列波动。
      A、随机  
      B、季节  
      C、循环  
      D、不规则

      答案:B 
      解析:`季节时间`序列波动是现象观察值在`一年之内`随季节变化而呈现出来的周期性波动。`循环时间`序列波动是现象在`较长时间`内呈现出的波浪式的起伏变动。不规则时间序列波动是一种随机波动，是由偶然因素引起的时间序列波动。根据题意可知描述的是季节时间序列波动，


  - 🔴(单选题)如果时间序列同时含趋势、季节变动和随机波动成分时，除了可以使用winter指数平滑模型预测外，还可以使用什么方法/模型进行预测？  
      A、Holt指数平滑  
      B、简单指数平滑  
      C、分解法  
      D、以上都不是

      正确答案：C

  - 🔴(单选题)在进行时间序列数据的成分拆解时，下列不属于重点识别成分的是（）  
      A、长期趋势  
      B、季节波动  
      C、随机波动  
      D、以上均是

      正确答案：C,解析：在进行时间序列数据的成分拆解时，重点识别序列中是否包含长期趋势和季节波动。

### 考点: 时间序列3种效应的组合方式❤️

- 内容: 
  - 加法模型，即三种效应是累加的。

      $$
      x_t=T_t+S_t+I_t, 
      $$

    其中，$T_t$代表趋势效应，$S_t$代表季节效应，$I_t$代表随机效应。

  - 乘积模型，即三种效应是累计的。
      $$
      x_t=T_t * S_t * I_t, 
      $$

- 题目: 
  - 🟢(多选题)在趋势分解法中，时间序列的成分与观测值的关系可以用()模型表示。
      A、加法模型  
      B、减法模型  
      C、乘法模型  
      D、除法模型

      答案:AC 


### 考点: 指数平滑法

- 参考
  
    参考[指数平滑法](../../../数学/统计学/13时间序列分析和预测/指数平滑法.md)

- 内容

    三种常见的指数平滑方法：
    1. Exponential smoothing(一次指数平滑, 简单指数平滑模型): 无趋势无季节
    1. Holt exponential smoothing(二次指数平滑，Holt模型): 有趋势无季节
    1. Holt-Winters exponential smoothing(三次指数平滑, Winter模型)：有趋势有季节

- 题目: 

  - 🔴(单选题)可以用于趋势成分和季节成分序列的预测是那种模型？  
      A、Winter模型  
      B、Holt模型  
      C、简单指数平滑模型  
      D、以上都不是

      正确答案：A





## ARMA方法

### 考点: AR模型❤️


- 内容: 
    AR模型(自回归模型, Auto Regression)，认为时间序列当期`观测值`与前$p$期有线性关系，而与前$p+1$期无线性关系。

    $$
    X_t = \alpha_0 + \alpha_1X_{t-1}+\alpha_2X_{t-2}+...+\alpha_pX_{t-p}+\epsilon_t, \epsilon_t \sim N(0,\sigma^2)
    $$

    其中, $X_t$表示第$t$的值, $\alpha$是回归系数,  $\epsilon_t$是一个独立于$X_t$的白噪声. 上式表示$X_t$与$X_{t-1},X_{t-2},...,X_{t-p}$有线性关系，


- 题目: 
  - 🟢(单选题)关于自回归模型说法错误的是()。
      A、自回归模型是用自身的数据进行预测  
      B、时间序列数据必须具有平稳性  
      C、自回归只适用于预测与自身前期相关的现象  
      D、自回归模型关注的是自回归模型中的误差项的累加

      答案:D, 移动平均模型关注的是误差项的累加


  - 🔴(多选题)AR模型平稳性的判别方法有？  
      A、散点图  
      B、单位根判别法  
      C、平稳域判别法  
      D、时序图
      
      正确答案：BCD

      答题技巧: 反向记忆, 排除散点图


### 考点: MA模型❤️

- 内容: 

    MA模型(移动平均模型, Moving Average)认为时间序列当期观测值与前时刻$t-1,t-2,...,t-q$进入系统的`扰动项`$\epsilon_{t-1}, \epsilon_{t-2},...,\epsilon_{t-q}$有相关关系

    $$
    X_t = \mu + \epsilon_t + \beta_1 \epsilon_{t-1} + ... + \beta_q \epsilon_{t-q}
    $$

    其中，$X_t$表示第$t$时刻的值, $\beta_q$是前$q$期的回归系数, $\epsilon$是白噪声过程。

- 题目: 
    
    - 🟢(单选题)关于自回归模型说法错误的是()。  
        A、自回归模型是用自身的数据进行预测  
        B、时间序列数据必须具有平稳性  
        C、自回归只适用于预测与自身前期相关的现象  
        D、自回归模型关注的是自回归模型中的误差项的累加

        答案:D, 移动平均模型关注的是误差项的累加


### 考点: ACF与PACF ❤️

- 内容: 

    ACF(自相关系数函数, Autocorrelation Coefficient Function): 描述任意两个时间间隔为k的时间序列的相关系数。
    
    $$
    ACF(k)=P_k= \frac{Cov(y_t,y_{t-k})}{Var(y_t)}
    $$

    PACF(偏自相关函数, Partial Autocorrelation Function):  描述时间序列任意两个时间间隔$k$的时刻，去除1至$k-1$这个时间段中的其他数据的相关系数, 可理解为, $x_{t-k}$影响着$x_t$, 同时也影响着$x_{t-k+1}$. 影响着$x_{t-k+1}$的力量传导到$x_t$, 形成了$x_{t-k}$对$x_t$的间接影响, 偏函数就是为了去除这个间接影响.

    $$
    p_k^* = Corr[y_t - E^*(y_t|y_{t-1},...,y_{t-k+1}),y_{t-k}]
    $$


    模型|ACF|PACF
    --|--|--
    AR|拖尾|p阶截尾
    MA|q阶截尾|拖尾
    ARMA|拖尾|拖尾

    > 记忆方法: 只记AR, 左拖右截, p阶截尾和PACF的p正好对应. 其他的按矩阵对称记忆.
    > pq按顺序, 所以AR是p, MA是q
    > AR是先拖尾, 再p截尾
    > MA是先q截尾, 再拖尾
    > p和q都是截尾

- 题目: 

  - 🟢(单选题)偏自相关系数在最初的d阶明显大于2倍标准差范围，d阶后突然衰减在零附近，属于( )。
        A、d阶截尾  
        B、d1阶截尾  
        C、d阶拖尾  
        D、d1阶拖尾

        答案:A 


  - 🔴(单选题)在时间序列建模的定阶过程中，若`ACF和PACF均呈现出拖尾的特征`，则常用的定阶指标是（O  
        A、ADF  
        B、VIF  
        C、AIC  
        D、AUC

        正确答案：C

        做题技巧: 排除AUC, VIF和不认识的ADF

   - 🔴AR(p)模型中p的什么含义
        A、差分的阶数
        B、自相关系数的截尾阶数
        C、偏自相关系数的截尾阶数
        D、自相关系数的拖尾阶数
        
        正确答案：C

  - 🔴(单选题)MA(q)模型中q的什么含义  
        A、差分的阶数  
        B、自相关系数的截尾阶数  
        C、偏自相关系数的拖尾阶数  
        D、自相关系数的拖尾阶数

        正确答案：B

  - 🔴(多选题)ARIMA(p,d,q)模型中p,d,q什么含义  
        A、偏自相关系数的截尾阶数  
        B、自相关系数的拖尾阶数  
        C、差分的阶数  
        D、自相关系数的截尾阶数

        正确答案：ACD

  - 🔴(单选题)假设使用statsmodels中的ARIMA建立模型如下ARIMA(data,order=(2,1,O).fit),则下列说法正确的是（）  
      A、在建模时对数据data进行了2阶差分  
      B、在建模时，MA模型的阶数为1  
      C、在建模时对数据data进行了1阶差分  
      D、在建模时，AR模型的阶数为0

      正确答案：C,解析：在使用statsmodels中的ARIMA建立模型时，参数order中的数值分别对应的是AR模型的阶数、差分的阶数、MA模型的阶数，上述的order参数为(2,1,O),故AR模型的阶数为2，差分的阶数为1,MA模型的阶数为0.

## ARIMA(autoRegressive integrated Moving average)

### 考点: 差分❤️

- 内容: 

    🟩通过差分等手段，将`非平稳时间序列`转换成平稳时间序列，再使用ARIMA模型建模。包含阶次差分和步次差分.
    
    - `阶次`差分主要用来消除`长期趋势`的影响
    
      - 1阶差分即当期观测减前一期的观测构成差分项，其数学表达式为: 
      $$
      \Delta x_t^{(1)} = x_t - x_{t-1}(t=2,3,...)
      $$
      - 2阶差分是在1阶差分的基础上，对1阶差分的结果再进行差分，其数学表达式为: 
      $$
      \Delta x_t^{(2)} = \Delta x_t ^ {(1)} - \Delta x_{t-1}^{(1)}
      $$
      - 以此类推，d阶差分是在d-1阶差分的基础上，对d-1阶差分的结果再进行差分，其数学表达式为: 
      $$
      \Delta x_t ^{(d)} = \Delta(\Delta x_t ^{(d-1)})
      $$

      一般来说，若序列蕴含着显著的线性趋势，1阶差分就可以实现趋势平稳:若序列蕴含着曲线趋势，通常高阶(2阶)差分就可以提取曲线趋势的影响。

    - `步次`差分主要用来消除`季节`效应的影响。



- 题目: 

  - 🟢(单选题)对于非平稳时间序列来说，大部分场景下将它转换成平稳时间序列的最好的方法是( )。  
      A、取对数  
      B、归一化  
      C、差分  
      D、数据标准化

      答案:C


  - 🔴(单选题)在时间序列建模时常常用到差分操作，其中阶次差分的作用是（）  
    A、消除季节效应的影响  
    B、消除循环效应的影响  
    C、消除长期趋势的影响  
    D、消除随机效应的影响

    正确答案：C,在差分操作中，包括阶次差分和步次差分，阶次差分主要用来消除长期趋势的影响，而步次差分主要用来消除季节效应的影响。



  - 🔴(单选题)在时间序列分析中，数据呈现出以季度为周期的长期向上的变化趋势，则建模之前需要进行的操作是（）  
    A、4阶差分  
    B、4步差分  
    C、先4阶差分，再4步差分  
    D、先1阶差分，再4步差分

    正确答案：D,在时序数据中，既有长期趋势又有周期变化时，应采用阶次差分和步次差分相结合的方式处理数据，消除长期趋势时采用阶次差分，通常是从低阶开始，`一般一阶、二阶`即可消除`长期趋势`，`季`节效应的消除需要进行`步次`差分，题中的季节效应是以季节为周期的，故应该进行4步差分。


  - 🔴(单选题)包含长期趋势和季节波动，在建模之前通常会进行差分处理，对以上序列而言，正确的操作是（）  
    A、进行阶次差分  
    B、进行步次差分  
    C、既进行阶次差分又进行步次差分  
    D、以上均可

    正确答案：C

  - 🟢(单选题)下列方法可以实现差分操作的是（）  
    A、data.vif（）  
    B、data.aic（）  
    C、data.bic（）  
    D、data.diff（）

    正确答案：D

