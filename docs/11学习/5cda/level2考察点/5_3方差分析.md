# 统计分析_方差分析
考纲:

- 领会
    - 方差分析的相关概念
    - 单因素方差分析的原理
    - 多因素方差分析的原理
    - 方差分析的统计量构造过程
- 熟知
    - 单因素方差分析的基本步骤
    - 总离差平方和（SST）的含义及计算
    - 组间离差平方和（SSA）的含义及计算
    - 组内离差平方和（SSE）的含义及计算
    - 单因素方差分析的原假设
    - 多因素方差分析的种类
    - 列联表检验的原理
- 应用
    - 实现单因素方差分析的步骤
    - 实现多因素方差分析的步骤
    - 对方差分析表的解读


分值:

c.方差分析（占比 5%）




## 考点: 方差分析的相关概念

- 🟢(单选题)方差分析是统计学中常用知识，下列关于方差分析的说法不正确的是()  
    A、方差分析是一种检验若干个正态分布的均值和方差是否相等的一种统计方法  
    B、方差分析是一种检验若干个独立正态总体均值是否相等的一种统计方法  
    C、方差分析实际上是一种F检验  
    D、方差分析基于偏差平方和的分解和比较

    正确答案：A



- 🟢(单选题)以下关于线性回归和方差分析的描述哪个是正确的？  
    A、线性回归中，自变量和因变量都必须是分类型变量。  
    B、方差分析中，自变量和因变量都是连续型变量。  
    C、在线性回归中，自变量是连续型变量，而因变量是分类型变量。  
    D、在方差分析中，自变量是分类型变量，而因变量是连续型变量。

    正确答案：D,线性回归用于分析连续型自变量对连续型因变量的影响，而方差分析(ANOVA)主要用于比较两个或多个组的
    平均数差异，通常自变量是分类型的，而因变量是连续型的。因此，答案D是正确的描述。



- 🟢(单选题)在饲料养鸡增肥的研究中，采用三种配方饲料喂养，观测鸡的体重变化，这种方差分析是( )。  
    A、双因素方差分析  
    B、单因素三水平方差分析  
    C、三因素方差分析  
    D、以上都不是

    答案:B 


- 🔴(单选题)关于单因素方差分析的描述，下列哪项是正确的？  
    A、单因素方差分析用于比较两个组的方差是否相同。  
    B、方差分析的原假设是至少有两组方差不相等。  
    C、单因素方差分析可以用来确定不同教育程度水平对信用卡消费影响的显菩性。  
    D、单因素方差分析不要求数据的总误差分为组内误差和组间误差。

    正确答案：C,单因素方差分析(NOVA)用于比较三个或更多组数据的均值差异，来看单个因素的不同水平（如教育程度）如何影响一个连续变量（如信用卡消费）。题目描述的应用场景正是这种分析的一个典型例子。因此，正确选项是C。选项A是错误的，因为方差分析不是用来比较方差的相同性，而是用来比较均值。选项B是错误的，因为方差分析的原假设是所有组的均值相等(即方差相等是关于均值的假设，并不直接针对方差)，而备择假设是至少有两组的均值有显菩差异。选项D是错误的，因为单因素方差分析确实要求将总误差分解为组内误差和组间误差。


- 🟢(单选题)如果方差分析的值小于给定的显著性水平0.05，这意味着()  
    A、所有生产线的效率都相同  
    B、至少有两个生产线的效率存在显著差异  
    C、所有生产线的效率都不同  
    D、无法确定生产线的效率是否存在差异


    正确答案：B 

## 考点: 方差分析的基本假设

内容:
    假设是`正态,独立,方差同`
    - 每个总体均服从正态分布  
    - 每个总体的方差相同  
    - 从每个总体中抽取的样本是相互独立的  

题目: 

- 🔴(多选题)以下属于单因素方差分析的假设的是（）  
    A、每个总体均服从正态分布  
    B、🔴每个总体的方差相同  
    C、从每个总体中抽取的样本是相互独立的  
    D、🔴残差序列不相关

    正确答案：A,B,C, 解析：ABC均属于单因素方差分析的前提假设，D选项属于线性回归模型中的经典线性假设的内容。
 

- 🔴(单选题)以下()项不是应用方差分析的前提条件。  
    A、各总体服从正态分布  
    B、各总体相互独立  
    C、各总体均值不等  
    D、各总体有相同的方差

    答案:C 
    解析:本题考查方差分析的前提条件。方差分析的前提条件包括各总体服从正态分布、各总体相互独立、各总体有相同的方差。而C选项各总体均值不等表述的是原假设和备择假设。因此本题选C。



- 🔴(单选题)下列不属于方差分析的前提假设的是（）  
    A、每个总体的样本量必须相同  
    B、每个总体均符合正态分布  
    C、每个总体的方差相等  
    D、从每个总体抽取的样本相互独立

    正确答案：A 解析：方差分析的前提假设包括每个总体均符合正态分布、每个总体的方差相等（方
    差齐性）、从每个总体抽取的样本相互独立，但每个总体的样本量可以不同。



- 🟢(单选题)单因子方差分析统计模型的应用需要一些前置条件，下列那项不属于单因子方差分析统计模型的假定？  
    A、各总体服从正态分布  
    B、各总体相互独立  
    C、各总体均值不等  
    D、各总体有相同的方差

    正确答案：C,解析：单因子方差分析统计模型的假定包括：每一总体均为正态总体；各总体的方差相同，从每一总体中抽取的样本是相互独立的。不包括C项

## 考点: 方差分析的步骤

1. 计算各分类样本组内的均值

    假定从第$i$个总体中抽取一个容量为$n_i$的简单随机样本，令$\overline{x}_i$为第$i$个总体的样本均值，则有:
    $$
    \overline{x}_i = \frac{\sum_{j=1}^{n_i} x_{ij}}{n_i}, i=1,2,...,k
    $$

    式中，$n_i$为第$i$个总体的样本量；$x_{ij}$为第$i$个总体的第$j$个观测值。

2. 计算全部观测值的总均值

    全部观测值的总和除以观测值总个数, 另总均值为$\overline{x}$, 有:
    $$
    \overline{x} = \frac{\sum_{i=1}^k\sum_{j=1}^{n_i} x_{ij}}{n} = \frac{\sum_{i=1}^k n_i \overline{x}_i}{n}
    $$

    其中, $n=n_1 + n_2 + ... + n_k$

3. 计算三个方差与$R^2$

    1. 总平方和(sum of squares for total), 记为SST。它是全部观测值$x_{ij}$, 与总均值$\overline{x}$的误差平方和，其计算公式为：

    $$
    SST = \sum_{i=1}^k \sum_{j=1}^{n_i} (x_{ij}-\overline{x})^2
    $$

    2. 组间平方和(sum of squares for factor A),记为SSA,它是各组均值$\overline{x}(i=l,2,...,k)$与总均值$\overline{x}$的误差平方和，反映各样本均值之间的差异程度，又称为因素平方和。其计算公式为：

    $$
    SSA = \sum_{i=1}^k n_i(\overline{x}_i - \overline{x})^2
    $$
    
    3. 组内平方和(sum of squares for error),记为SSE。它是每个水平或组的各样本数据与其组均值的误差平方和，反映每个样本各观测值的离散状况，又称为误差平方和。该平方和反映了随机误差的大小，其计算公式为：
    $$
    SSE = \sum_{i=1}^k \sum_{j=1}^{n_i}(x_{ij}-\overline{x}_i)^2
    $$

    4. 计算$R^2$
    
    组内平方和(SSE)仅包含`随机误差(random error)`
    组间平方和(SSA)包含`随机误差` + `系统误差(system error)`

    可以用组间平方和(SSA)占总平方和(SST)的比例大小来反映，将这一比例记为R,即
    
    $$
    R^2 = \frac{SSA(组间SS)}{SST(总SS)}
    $$

4. 计算F统计量


    1. SSA的均方也称组间均方或组间方差，记为MSA,其计算公式为：
    
    $$
    MSA = \frac{组间平方和}{自由度}=\frac{SSA}{k-1}
    $$

    2. SSE的均方也称为组内均方或组内方差，记为MSE,其计算公式为：
    
    $$
    MSE = \frac{组内平方和}{自由度} = \frac{SSE}{n-k}
    $$


    > 区别于含有p个变量的多元回归模型，样本量为$n$，该模型的回归平方和、残差平方和的自由度分别为()。$p、n-p-1$  


    1. 将上述MSA和MSE进行对比，即得到所需要的检验统计量$F$。当$H_0$为真时，二者的比值服从分子自由度为$k一1$、分母自由度为$n一k$的$F$分布，即
        
        $$
        F = \frac{MSA}{MSE}\sim F(k-1,n-k)
        $$


## 考点: 自由度

- 🔴(单选题)在单因子方差分析中，因子A有4个水平，每个水平下重复次数分别为5,7,6,10,那么误差平方和、因子平方的平方和及总平方和的自由度分别为？
    A、24, 4, 28
    B、24, 3, 28
    C、24, 3, 27
    D、25, 3, 28

    正确答案：C,
    解析：总试验次数n是28，水平数r=4,所以误差平方和的自由度为n-r=24,因子平方和=r-1=3,总平方和=n-1=27


- 🟢(单选题)已知在单因素方差分析试验中，因子水平数为r,总试验次数为n，则对于组内误差平方和描述正确的是  
    A、反映的是随机因素的影响  
    B、自由度为r-1  
    C、自由度为n-1  
    D、反映的是随机因素和系统因素的影响

    正确答案：A,解析：单因素方差分析的组内误差平方和的自由度为n-r，反映的是随机误差引起的数据间的差异



- 🟢(单选题)在比较因子A各水平下均值是否相等的单因子方差分析试验中，已知因子A有r个水平，从每个水平下的总体获得m个试验结果，(总试验次数n=r×m)，那么因子偏差平方和的自由度和误差偏差平方和的自由度分别是？  
    A、r,n  
    B、r-n.n-r  
    C、r-1,n-r  
    D、n-r,r-1

    正确答案：C,解析：在该问题中因子偏差平方和的自由度为r-1，误差偏差平方和的自由度为n-r，总误差的自由度为n-1。详细推算请参考茆诗松的《概率论与数理统计》

## 考点: 组间与组内

- 🟢(单选题)关于单因素方差分析，下列说法不正确的是  
    A、组间平方和只包含系统误差  
    B、组内平方和只包含随机误差  
    C、如果组间均方远大于组内均方，那么就说明不同水平之间均值存在着显著差异  
    D、如果组间均方远大于组内均方，那么就说明分类变量对于数值变量有显著影响

    正确答案：A

- 🟢(多选题)在方差分析中，数据的误差是用平方和来表示的，下列描述正确的是  
    A、反映各观测值误差大小的平方和称为组内平方和  
    B、反映各观测值误差大小的平方和称为组间平方和  
    C、反映各水平之间误差大小的平方和称为组间平方和  
    D、反映各水平之间误差大小的平方和称为组内平方和  

    正确答案：A,C

### F统计量

- 🟢(单选题)单因素方差分析中的统计量是用来测试什么假设？  
    A、所有类别内数据的方差相等。  
    B、各类别之间的均值都无显菩性差异。  
    C、至少有一组类别内的数据与总体均值有显菩性差异。  
    D、至少有两组类别间的均值有显著性差异。

    正确答案：D,单因素方差分析的F统计量是用来测试是否有足够的证据拒绝各组之间均值相等的原假设。这个原假设认为所有处理组的均值都是相等的。当F统计量的值足够大时，比较其对应的P值与显菩性水平，如果P值小于显菩性水平(如0.05)，则有足够的证据拒绝原假设，接受备择假设，即至少有两组之间的均值有显菩性差异。因此，正确答案是D。其他选项要么与F统计量的用途不相关(如A),要么描述的是原假设而非通过F统计量测试的内容(如B和C)。

- 🟢(单选题)方差分析的原理是进行F检验，下列关于F统计量的计算说法正确的是（）（其中，SSA表示组间偏差平方和，SSE表示组内偏差平方和，MSA表示组间均方，MSE表示组内均方）  
    A、F=SSA/SSE  
    B、F=SSA/MSA  
    C、F=SSE/MSE  
    D、F=MSA/MSE

    正确答案：D

### 考点: 方差分析表

- 🟩内容:
    记忆: 
    - 列名: 从左到右依次是 离差平方和(SS), 自由度(df), 离差均方(MS), F值
    - 行名: 先外后内
    - 自由度, 组间$k-1$, 组内$n-k$
    - 方差分析表(analysis of variance table), 一般形式为:
    
        误差来源|平方和(SS)|自由度(df)|均方(MS)|F值|P值|F临界值
        --|--|--|--|--|--|--
        组间(因素影响)|SSA|$k-1$|MSA|MSA/MSE
        组内(误差)|SSE|$n-k$|MSE
        总和|SST|$n-1$

- 题目:

    - 🔴(单选题)错误的是:
        差异源|SS|df|MS|F|P-value|Fcrit
        --|--|--|--|--|--|--
        组间|0.245|1|0.245|0.12|0.72979|33.940163
        组内|196|96|2.041667
        总计|196.245|97

        A、这是单因素方差分析的输出结果  
        B、表中`F<Fcit`,与P-value大于显著性水平是等价的  
        C、表内组间均方差没有显著大于组内均方差  
        D、由于组内SS数值显著大于组间SS,因此可以推断不同分类对于数值变量是有显著影响的

        答案: D

    - (单选题)

        差异源|SS|df|MS|F
        --|--|--|--|--
        组间|30|B|C|E
        组内|A|20|D
        总计|70|25

        表中A,B,C,D,E五个单元格内的数据分别是（）。  
        A、40,5,35,60,1.71  
        B、40,5,35,60,5  
        C、40,5,6,2,3  
        D、2.33,1.25,31.25,22.33,1.40

        正确答案：C



## 考点: 实操


- (多选题)使用EXCEL进行方差分析时，可以完成的分析包括（）  
A、单因素方差分析  
B、带有交互项的双因素方差分析  
C、不带交互项的双因素方差分析  
D、以上均不可以实现

正确答案：A,B,C,


## 大题
- 🟩内容:
    记忆: 
    - 列名: 从左到右依次是 离差平方和(SS), 自由度(df), 离差均方(MS), F值
    - 行名: 先外后内
    - 自由度, 组间$k-1$, 组内$n-k$
    - 方差分析表(analysis of variance table), 一般形式为:
    
        误差来源|平方和(SS)|自由度(df)|均方(MS)|F值|P值|F临界值
        --|--|--|--|--|--|--
        组间(因素影响)|SSA|$k-1$|MSA|MSA/MSE
        组内(误差)|SSE|$n-k$|MSE
        总和|SST|$n-1$

- 题目:
    
    模型$y=1.7+0.84x$的方差分析表, 如下:
    --|SS|--|--|--
    --|--|--|--|--
    Regression|6.44|(2)|(4)|(5)
    Error|3.4|18|0.19
    Total|(1)|(3)

    - (单选题)(1)的计算结果  
        A.6.44  
        B.3.4  
        C.9.84  
        D.3.04  

        正确答案：C

    - (单选题)(2)的计算结果  
        A.1  
        B.2  
        C.3  
        D.4
        
        正确答案：A, 方程中含有两个变量(水平)(自变量系数和截距)

    - (单选题)(3)的计算结果  
        A.17  
        B.18  
        C.19  
        D.20
        
        正确答案：C


    - (单选题)(4)的计算结果  
        A.6.44  
        B.3.22  
        C.6.55  
        D.9.66  
        
        正确答案：A,


    - (单选题)(5)的计算结果
        A.16.95
        B.33.89
        C.18.1
        D.20.5
        正确答案：B