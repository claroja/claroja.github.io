# 统计模型

模型: 现实世界的抽象
建模: 制作模型, 统计建模就是制作统计模型

## 简化复杂的世界
啤酒的销售额会受到多种因素的影响, 比如当天的温度和湿度, 棒球队的输赢, 国家的经济形势, 喜好啤酒的人数, 以及15个月前的暖流的运动(它会影响海水温度, 而海水温度可以决定下酒鱼的捕获量)等.

但是, 如果考虑所有可能的原因, 建模工作会非常的低效, 而且得到的结果会超出人类的理解范围. 一般来说, 人们很难相信暖流的变化会让15个月后的啤酒销售额平均增加50元.

如果直接忽略大部分因素, 只关注当天气温的影响, 那就简单了. 天气热, 所以想喝啤酒--这样的逻辑就很容易让人接受. 但是如果过度简化, 模型又会与现实严重脱节.

模型要充分简单, 让人类能够理解, 又要充分完善, 能够适当解读复杂的现实. 我们要制作的就是这种**面向复杂世界的简单模型**

### 从某个角度观察复杂的对象
模型可以理解为从某个角度观察现实多得到的结果.

气温与啤酒的关系, 就相当于从当天的气温这个角度观察啤酒销售额所得到的模型.
喜好啤酒的人数与啤酒销售额的关系, 就相当于从长期变动的消费者人数这个角度观察啤酒销售额所得的模型.

这些角度无所谓对错, 观察的切入点和建立的模型都可以随着分析目的的改变而变化.

### 数学模型
数学模型使用数学式来表示现象.
考虑啤酒销售额随气温变化的模型. 为了得知销售额随着气温升高而增加还是随着气温降低而增加, 我们用数学模型来表示:
$$
啤酒销售额(万元) = 20 + 4 \times 气温
$$
气温增加1度, 销售额就增加4万元. 当气温为0度时, 销售额为20万元; 气温为20度时, 销售额为100万元.


### 概率模型
概率模型是数学模型中用概率语言描述的模型.
现实中不可能在气温为20度时啤酒的销售额就恰好是100万元. 在同样的气温下, 有卖的更好的时候, 也有卖的更坏的时候, 不过这些情况的均值应该是100万元. 对于这种情况, 我们可以使用概率模型来表示. 要想使用概率模型, 就要使用概率分布.

其中正态分布时很常用的(具体使用哪种分布需要结合具体数据来判断, 广义线性模型中常见的还有泊松分布和二项分布)

假设销售额服从正态分布, 则销售额与气温的关系这个概率模型表示如下:
$$
啤酒销售额 \sim N(20+4\times 气温, \sigma^2)
$$
啤酒销售额服从均值为$20 + 4 \times 气温$, 方差为$\sigma^2$的正态分布.

上式还可以改写成:
$$
啤酒销售额 = 20 + 4 \times 气温 + \sigma, \sigma \sim N(0, \sigma^2)
$$
啤酒的销售额为$20 + 4 \times 气温 + 服从均值为0, 方差为\sigma^2的正态分布的噪声$.


### 统计模型
统计模型是基于数据建立大的概率模型.

例如, 调查30个气温为20度的日子的日销售额, 最终得到的结果是销售额均值为110万元, 方差为2. 这就和概率模型"当气温为20度时销售额均值为100万元"冲突了, 表明概率模型与数据不匹配.

又调查了多个气温为30度的日子的日销售额, 得到的销售额均值为160万元, 那么一下概率模型更适用这份数据:
$$
啤酒销售额 \sim N(10 + 5 \times 气温, \sigma^2)
$$
在制作统计模型时, 要局域概率模型的结构, 结合实际数据调整模型参数.


## 建模方法
响应变量: 根据某个因素而变化的变量. 例如, 啤酒的销售额就是响应变量.
解释变量: 对关注的对象的变化进行解释的变量. 例如, 气温都是解释变量.
概率模型多记作:$响应变量 \sim 解释变量$. 响应变量也叫因变量, 解释变量也叫自变量.

### 线性模型
在线性模型中, 响应变量和解释变量之间的关系为线性关系. 比如:
$$
啤酒销售额 = 20 + 4 \times 气温
$$
在这个模型中, 气温每升高1度, 销售额就增加4万元. 而且无论当前是20度还是30度, 这个关系都已知保持不变.

### 系数与权重
统计模型中使用的参数叫做系数. 例如:
$$
啤酒销售额 \sim N(\beta_0 + \beta_1 \times 气温, \sigma^2)
$$
其中, $\beta_0$和$\beta_1$都叫做系数, 其中$\beta_0$叫做截距, $\beta_1$叫做回归系数. 通过这些系数和解释变量(气温), 可以预测参数(正态分布的均值). 在机器学习领域中$\beta$也成为权重.

### 建模 = 模型选择 + 参数估计
建模分为两个步骤:
1. 模型选择, 使用数学式子表达模型的结构
2. 参数估计, 就是估计系数


### 变量选择
变量选择就是未模型选择解释变量. 在选择变量前, 首先要把各种变量组合在一起建模. 例如存在A, B, C3个解释变量, 那么可能出现以下几种组合:
1. $响应变量 \sim 无解释变量$
2. $响应变量 \sim A$
3. 2. $响应变量 \sim B$
4. 2. $响应变量 \sim C$
5. 2. $响应变量 \sim A + B$
6. 2. $响应变量 \sim A + C$
7. 2. $响应变量 \sim B + C$
8. 2. $响应变量 \sim A + B + C$

如果响应变量是啤酒销售额, 解释变量就是气温, 天气, 啤酒价格等

选出最合适的变量组合有两种方法, 分别是假设检验和信息准则
### 通过假设检验选择变量
$$
啤酒销售额 \sim N(\beta_0 + \beta_1 \times 气温, \sigma^2)
$$
使用假设检验, 提出以下假设:
1. 零假设: 解释变量的系数$\beta_1$是0
2. 备选假设: 解释变量的系数$\beta_1$不是0

如果拒绝零假设, 就认定气温的系数不是0, 也就相当于认定模型中需要气温这个解释变量.
如果不能拒绝零假设, 就依照模型应当足够简单的原则去掉相关变量(气温). 如果去掉的是唯一的解释变量, 模型就变为空模型.

### 通过信息量准则选择变量
赤池信息量准则(akaike information criterion, AIC)越小, 模型越合适.

