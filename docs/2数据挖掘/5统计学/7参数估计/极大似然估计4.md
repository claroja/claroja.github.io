# 极大似然估计(Maximum Likelihood Estimation, MLE)

大似然估计，又被称作最大似然估计可在给定概率分布模型的条件下用于模型参数的估计，即所谓的参数估计.



## $P(x;θ)$


先来了解下$P(x;θ)$，其中$x$就是概率中常见的随机变量，而$θ$则是该概率分布模型的模型参数。在不同概率分布模型中有各自不同的模型参数，比如二项分布的$р$，正态分布的$μ、σ$。

- 一般情况下见到更多的是，概率分布的模型参数$θ$是已知的、确定的，则此时$P(x;θ)$就是我们常见的在确定的分布模型下随机变量$x$的概率；
- 而如果反过来，随机变量$x$是已知的，则此时$P(x;θ)$表示的就是在不同的模型参数$θ$条件下出现给定样本$x$的概率。

这就是对于$P(x;θ)$理解的一体两面。显然在参数估计过程中，对$P(x;θ)$取后一种理解


## 基本原理

所谓参数估计，就是估计出概率分布中的模型参数$θ$。首先进行$n$次抽样实验，记抽样结果为$x_1, x_2, ..., x_n$ 。那仅仅根据这$n$个抽样结果，该如何估计出此概率分布的模型参数呢？这就引入了我们的今天的主题了——MLE极大似然估计。其依据的思想也很简单，即概率越大越有可能发生(最大似然可以理解为最为相似，即最大的可能性)。即使得当前抽样结果发生概率$L(θ)$最大的模型参数$θ$，就是我们所需的参数估计值。即:

$$
\mathop{\arg\max}\limits_{\theta} L(\theta) = \mathop{\arg\max}\limits_{\theta} L(x_1, x_2,..., x_n;\theta)=\mathop{\arg\max}\limits_{\theta} P(x_1, x_2,..., x_n;\theta)
$$


其中$L(θ)$被称为样本的似然函数。大多数情况下，$n$次抽样实验相互之间满足独立同分布$(i.i.d)$，则有

$$
\mathop{\arg\max}\limits_{\theta} L(x_1, x_2,..., x_n;\theta) = \mathop{\arg\max}\limits_{\theta} \prod_{i=1}^n P(x_i;\theta)
$$

## 求解步骤

MLE极大似然估计在参数估计过程中的基本步骤：

1. 建立似然函数$L(θ)$
2. 对$L(θ)$取对数，得对数似然函数$lnL(θ)$
3. $lnL(θ)$对$θ$求导并令其为0，计算极值点
4. 模型参数$θ$得解


其中, 第2个步骤取对数是由于一方面$ln$对数单调递增的特性使得其不会改变极值点；而更重要的原因在于取对数后, 将乘法运算转换为加法运算, 方便我们后续的求导工作.



## 案例

### 离散型概率分布
以离散型概率分布中的二项分布为例:

袋子里面装了黑、白两种颜色的球。记从袋子中摸到黑球、白球的概率分别为$θ、1-θ$。假设某人进行了10次随机抽样，每次`都是`有放回`的从袋子中摸出一个球，其抽样结果为7次黑球、3次白球。试估计出概率$p$的值.

1. 建立似然函数$L(θ)$

    $$
    L(θ) = L(x_1, x_2, ..., x_{10}; θ) = \prod_{i=1}^{10} P(x_i; θ) = θ^7 \cdot (1-θ)^3
    $$

2. 对$L(θ)$取对数，得对数似然函数$lnL(θ)$

    $$
    lnL(p) = 7 \cdot lnθ + 3 \cdot ln(1-θ)
    $$

3. $lnL(θ)$对$θ$求导并令其为0，计算极值点

    $$
    (lnL(θ))' = \frac{7}{p} - \frac{3}{1-p} =0
    $$

4. 模型参数$θ=0.7$得解 


## 连续型概率分布

在连续型概率分布中，其不存在分布律，取而代之的是概率密度函数$f$。则对于$n$个样本而言，其概率可近似地为:
$$
\prod_{i=1}^n f(x_i;θ)dx_i
$$

但由于因子$\prod_{i=1}^n d x_i$并不随$θ$变化，故在连续型概率分布下其似然函数为:

$$
L(θ) = L(x_1, x_2, ..., x_n; θ) = \prod_{i=1}^n f(x_i;θ)
$$

选用典型的正态分布作为实例，来展示如何通过MLE对正态分布的模型参数进行估计。根据上文可知，我们可直接通过概率密度函数来构建似然函数:

1. 建立似然函数$L(θ)$

$$
\begin{split} 
L(\mu, \sigma^2)& = \prod_{i=1}^n f(x_i;\mu, \sigma) \\
&=\prod_{i=1}^n \frac{1}{\sqrt{2\pi} \cdot \sigma} \cdot e^{-\frac{(x_i - \mu)^2}{2 \sigma^2}} \\
&=(\frac{1}{\sqrt{2\pi} \cdot \sigma})^n \cdot e^{-\sum_{i=1}^n \frac{(x_i - \mu)^2}{2 \sigma^2}} \\
&=(2 \pi \cdot \sigma^2)^{- \frac{n}{2}} \cdot e^{-\sum_{i=1}^n \frac{(x_i - \mu)^2}{2 \sigma^2}} \\
\end{split}
$$

2. 对$L(θ)$取对数，得对数似然函数$lnL(θ)$

$$
\begin{split} 
ln L (\mu, \sigma^2) &= - \frac{n}{2} \cdot ln(2 \pi \cdot \sigma^2) - \sum_{i=1}^n \frac{(x_i - \mu)^2}{2 \sigma^2} \\
& = - (ln(2\pi)+ln(\sigma^2)) - \frac{1}{2\sigma^2}\sum_{i=1}^n (x_i - \mu)^2

\end{split}
$$


3. $lnL(θ)$对$θ$求偏导并令其为0，计算极值点

$$
\begin{cases}
\frac{\partial ln L}{\partial \mu} = \frac{1}{\sigma^2} \cdot \sum_{i=1}^n (x_i - \mu) = 0  \\
\frac{\partial ln L}{\partial \sigma} = -\frac{n}{2 \sigma^2} + \frac{1}{2 \sigma^4} \sum_{i=1}^n (x_i -\mu)^2 = 0
\end{cases}
$$



4. 求解上式，可得正态分布的模型参数在MLE下的估计值

$$
\begin{cases}
\mu = \frac{1}{n} \sum_{i=1}^n x_i \\
\sigma^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \mu)^2
\end{cases}
$$

可以看到对于正态分布而言，其均值的极大似然估计量即是样本的均值；而其方差的极大似然估计量却是 样本数据的总体方差值(即分母为n) ，而不是 样本数据的样本方差值(即分母为n-1) ，故正态分布方差的极大似然估计量是有偏的





## 参考:
- https://zhuanlan.zhihu.com/p/163258672