# 概率vs似然(probabilityVSlikelihood)

## 概率(probability)
假设有一个均匀的硬币, 正面和方面的概率都是0.5, 抛掷3次, 那么我们就可以计算出正面(Head), 正面(Tail), 反面的概率.

$$
P(HHT|p=0.5)= 0.5 * 0.5 * 0.5 = 0.125
$$

这里`HHT`被称为假设(hypothsis), 而`p=0.5`被称为证据(evidence). 即已知正反概率是0.5, 则发生`HHT`的概率是多少?. 

$$
P(hypothesis|evidence) = P(HHT|p=0.5)
$$

概率就是: 已知模型(`HHT`)和参数(`p=0.5`)求模型的输出结果.

## 似然(likelihood)
在不知道是否均匀硬币的前提下, 抛掷3次, 得到了正面, 正面, 反面的结果, 求该硬币单次抛掷正面反面的概率.

$$
P(p=0.5|HHT)
$$

这里`p=0.5`是假设, 而`HHT`是证据. 即在已知`HHT`前提下, 发生`p=0.5`的概率是多少?

这里不妨假设正面有9种概率的可能, $P_h=[0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]$. 可以分别计算在这9种可能下的似然:
- $P_h=0.1=0.1*0.1*0.9 * 100= 0.9$
- $P_h=0.2=0.2*0.2*0.8 * 100= 3.2$
- $P_h=0.3=0.3*0.3*0.7 * 100= 6.3$
- $P_h=0.4=0.4*0.4*0.6 * 100= 9.6$
- $P_h=0.5=0.5*0.5*0.5 * 100= 12.5$
- $P_h=0.6=0.6*0.6*0.4 * 100= 14.4$
- $P_h=0.7=0.7*0.7*0.3 * 100= 14.7$
- $P_h=0.8=0.8*0.8*0.2 * 100= 12.8$
- $P_h=0.9=0.9*0.9*0.1 * 100= 8.1$

我们可以看到, 当硬币正反面均匀, 即获得正面反面概率均为0.5时, 获得`HHT`的概率是12.5%(和上小节一致), 但$P_H=0.5$并非最大的似然(maximum likelihood), $P_h=0.7$会更大概率获得`HHT`组合, 才是最大似然.

概率就是: 已知模型(`HHT`)和模型的输出结果(`HHT`不同组合的概率), 求参数(`p`)

## 案例


### 概率

假设盒子里有4个红球, 3个绿球, 不放回的抽取. 问依次取到红绿红的概率是多少, 即$P(RGR|R=4,G=3)$.

1. 总共有7个球在盒子里, $P(red)=\frac{4}{7}$, $P(green)=\frac{3}{7}$, 第1次取得红球的概率是$\frac{4}{7}$
2. 现在有6个球在盒子里, $P(red)=\frac{3}{6}$, $P(green)=\frac{3}{6}$, 第2次取得绿球的概率是$\frac{3}{6}$
3. 现在有5个球在盒子里, $P(red)=\frac{3}{5}$, $P(green)=\frac{2}{5}$, 第三次取得红球的概率是$\frac{3}{5}$
4. 最终, $P(RGR|R=4,G=3)=\frac{4}{7}*\frac{3}{6}*\frac{3}{5}=0.17$, 即依次获得红绿红的概率是0.17

在这个例子中, 我们知道模型的参数, 即球的个数.



### 似然

现在假设盒子里有10个球, 分别是红色(red), 绿色(green), 蓝色(blue), 但是我们不知道每个颜色分别有多少. 如果不放回的抽取, 依次抽到了绿红绿, 那么红, 绿, 蓝各自有多少个呢? 显然我们不能100%的确定, 我们只能做似然(likelihood)估计.

- 有66种的红绿蓝组合
- 不是所有的组合都是有效的
    - 最少有1个红色的
    - 最少有2个绿色的
- $P(GRG)=\frac{G}{10}*\frac{R}{9}*\frac{G-1}{8}$


使用python来试验:
1. `balls`包含了所有组合的可能, $11*11*11=1331$.

    ```python
    from itertools import product
    numbers = range(0, 11)  # [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    balls = product(numbers, repeat=3)
    balls = list(balls)
    ```


2. 现在挑选出符合案例的组合, 即求和$=0$的组合.

    ```python
    sum_to_10 = [combination for combination in balls if sum(combination) == 10]
    len(sum_to_10)  # 66
    ```

    再次过滤, 最少有1个红球和2个绿球

    ```python
    valid = [combination for combination in sum_to_10 if ((combination[0]>0) * (combination[1]>1))]
    len(valid)  # 36
    ```

3. 最后, 计算`GRG`的每种组合的概率:

    ```python
    likelihood = {}

    for r,g,b in valid:
        key = str(r)+str(g)+str(b)
        l = (g/10)*(r/9)*((g-1)/8)
        
        likelihood[key] = round(l*100, 2)

    """
    127 0.28
    136 0.83
    145 1.67
    154 2.78
    163 4.17
    172 5.83
    181 7.78
    190 10.0
    226 0.56
    235 1.67
    244 3.33
    253 5.56
    262 8.33
    271 11.67
    280 15.56
    325 0.83
    334 2.5
    343 5.0
    352 8.33
    361 12.5
    370 17.5
    424 1.11
    433 3.33
    442 6.67
    451 11.11
    460 16.67
    523 1.39
    532 4.17
    541 8.33
    550 13.89
    622 1.67
    631 5.0
    640 10.0
    721 1.94
    730 5.83
    820 2.22
    """
    ```

现在我们获得了模型所有的似然参数. 如, 如果盒子里有2个红球, 7个绿球, 1个蓝球, 那么就有11.67%的概率获得`GRG`的组合.

如果我们想要最优的组合, 那么我们将选择最大似然(maximum likelihood). 即3个红球7个绿球0个蓝球. 即是说我们有17.5%的概率确定盒子里有3个红球7个绿球0个蓝球.




## 参考
- [probability-vs-likelihood](https://medium.com/analytics-vidhya/probability-vs-likelihood-873dcfe15df8)






