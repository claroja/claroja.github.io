# 平稳序列的预测

平稳时间序列通常只含有随机成分，其预测方法主要有简单平均法、移动平均法和指数平滑法等，这些方法主要是通过对时间序列进行平滑以消除随机波动，因而也称为平滑法。平滑法既可用于对平稳时间序列进行短期预测，也可用于对时间序列进行平滑以描述序列的趋势（包括线性趋势和非线性趋势）。

## 简单平均法
简单平均法是根据已有的$t$期观察值通过简单平均来预测下一期的数值。设时间序列已有的$t$期观察值分别为$Y_1,Y_2,...,Y_t$则$t+1$期的预测值$F_{t+1}$为：

$$
F_{t+1} = \frac{1}{t}(Y_1+Y_2+...+Y_t)=\frac{1}{t}\sum_{i=1}^tY_i
$$

到了$t+1$期后，有了$t+1$期的实际值，便可计算出$t+1$期的预测误差$e+1$:

$$
e_{t+1} = Y_{t+1}-F_{t+1}
$$

于是, $t+2$期的预测值为:

$$
F_{t+2} = \frac{1}{t+1}(Y_1+Y_2+...+Y_t+Y_{t+1})=\frac{1}{t+1}\sum_{i=1}^{t+1}Y_i
$$


简单平均法适合对较为平稳的时间序列进行预测，即当时间序列没有趋势时，用该方法比较好。但如果时间序列有趋势或季节成分，该方法的预测则不够准确。此外，简单平均法将远期的数值和近期的数值看作对未来同等重要。但从预测角度看，近期的数值比远期的数值对未来有更大的作用，因此简单平均法预测的结果不够准确。

## 移动平均法

移动平均法(moving average)是通过对时间序列逐期递移求得平均数作为预测值的一种预测方法，其方法有简单移动平均法(simple moving average)和加权移动平均法(weighted moving average)两种。这里主要介绍简单移动平均法。

简单移动平均是将最近的$k$期数据加以平均，作为下一期的预测值。设移动间隔为$k(1<k<t)$,则$t$期的移动平均值为：
$$
\overline{Y}_t = \frac{Y_{t-k+1}+Y_{t-k+2}+...+Y_{t-1}+Y_t}{k}
$$

$t+1$期的简单移动平均预测值为：
$$
F_{t+1} = \overline{Y}_t = \frac{Y_{t-k+1}+Y_{t-k+2}+...+Y_{t-1}+Y_t}{k}
$$

同样, $t+2$期的预测值为:

$$
F_{t+2} = \overline{Y}_{t+1} = \frac{Y_{t-k+2}+Y_{t-k+3}+...+Y_{t}+Y_{t+1}}{k}
$$



移动平均法只使用最近k期的数据，在每次计算移动平均值时，移动的间隔都为k.该方法也适合对较为平稳的时间序列进行预测。应用时，关键是确定合理的移动间隔k.对于同一个时间序列，采用不同的移动间隔，预测的准确性是不同的。可通过试验选择一个使均方误差最小的移动间隔。


## 指数平滑法

指数平滑法(exponential smoothing)是通过对过去的观察值加权平均进行预测的一种方法，该方法使$t+1$期的预测值等于$t$期的实际观察值与$t$期的预测值的加权平均值。指数平滑法是加权平均的一种特殊形式，观察值的时间越久远，其权数呈现指数下降，因而称为指数平滑。指数平滑法有一次指数平滑法、二次指数平滑法、三次指数平滑法等，本节主要介绍一次指数平滑法。

一次指数平滑法也称单一指数平滑法(single exponential smoothing),它只有一个平滑系数，而且观察值离预测时期越久远，权数越小。一次指数平滑法将一段时期内的预测值与观察值的线性组合作为$t+1$期的预测值，其预测模型为：
$$
F_{t+1} = \alpha Y_t + (1-\alpha)F_t
$$
其中, $Y_t$为$t$期的实际观察值；$F_t$为$t$期的预测值；$\alpha(0<\alpha<1)$为平滑系数。

可以看出，$t+1$期的预测值是$t$期的实际观察值与$t$期的预测值的加权平均值。由于开始计算时还没有1期的预测值$F_1$,通常可以设$F_1$,等于1期的实际观察值，即$F_1=Y_1$。因此2期的预测值为：

$$
F_2 = \alpha Y_1 + (1-\alpha)F_1 = \alpha Y_1 + (1-\alpha)Y_1 = Y_1
$$

3期的预测值为：
$$
F_3 = \alpha Y_2 + (1-\alpha)F_2 = \alpha Y_2 + (1-\alpha)Y_1 = Y_1
$$
3期的预测值为：
$$
F_4 = \alpha Y_3 + (1-\alpha)F_3 = \alpha Y_3 + \alpha(1-\alpha)Y_2 + (1-\alpha)^2Y_1
$$

依此类推。可见任何预测值$F_{t+1}$都是以前所有的实际观察值的加权平均。尽管如此，并非所有过去的观察值都需要保留，以计算下一期的预测值。实际上，一旦选定平滑系数α，只需要两项信息就可以计算预测值。只要知道$t$期的实际观察值$Y_t$,与$t$期的预测值$F_t$,就可以计算$t+1$期的预测值。
$$
F_{t+1} = \alpha Y_t + (1 - \alpha)F_t \\
=\alpha Y_t + F_t - \alpha F_t \\
=F_t + \alpha(Y_t - F_t)
$$

可见，$F_{t+1}$是$t$期的预测值$F_t$,加上用$\alpha$调整的$t$期的预测误差$Y_t-F_t$,。

使用指数平滑法时，关键的问题是确定一个合适的平滑系数$\alpha$，因为不同的$\alpha$会对预测结果产生不同的影响。例如，当$\alpha=0$时，预测值仅仅是重复上一期的预测结果；当$\alpha=1$时，预测值就是上一期的实际值。预测时，可选择不同的$\alpha$，然后找出预测误差最小的作为最后的$\alpha$值。


